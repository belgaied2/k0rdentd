{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"K0rdentd Documentation","text":"<p>Welcome to the K0rdentd documentation! K0rdentd is a CLI tool that automates the deployment of K0s and K0rdent on a VM. It follows a similar pattern to RancherD but simplifies the architecture by directly configuring K0s and using its built-in helm extension mechanism.</p>"},{"location":"#what-is-k0rdentd","title":"What is K0rdentd?","text":"<p>K0rdentd simplifies the installation and management of K0rdent, a Kubernetes cluster management platform. It handles:</p> <ul> <li>K0s Installation: Automatically downloads and installs K0s binary</li> <li>K0rdent Deployment: Deploys K0rdent using K0s's Helm extension mechanism</li> <li>Cloud Provider Credentials: Creates credentials for AWS, Azure, and OpenStack</li> <li>Airgap Support: Full offline installation support for isolated environments</li> <li>UI Exposure: Automatically exposes the K0rdent UI for easy access</li> </ul>"},{"location":"#key-features","title":"Key Features","text":""},{"location":"#simple-installation","title":"\ud83d\ude80 Simple Installation","text":"<pre><code># Download K0rdentd\ncurl -sfL https://k0rdentd.belgai.de | sudo bash\n\n# Install K0s and K0rdent in one command\nsudo k0rdentd install\n</code></pre>"},{"location":"#cloud-provider-support","title":"\ud83d\udd0c Cloud Provider Support","text":"<p>Configure credentials for multiple cloud providers:</p> <pre><code>k0rdent:\n  credentials:\n    aws:\n      - name: aws-prod\n        accessKeyID: AKIA...\n        secretAccessKey: secret...\n    azure:\n      - name: azure-prod\n        clientID: client-id...\n        clientSecret: secret...\n        tenantID: tenant-id...\n</code></pre>"},{"location":"#airgap-installation","title":"\ud83c\udf10 Airgap Installation","text":"<p>Full offline installation support for air-gapped environments:</p> <pre><code># Start local registry\nsudo k0rdentd registry --bundle-path /path/to/bundle.tar.gz\n\n# Install in airgap mode\nsudo k0rdentd install --airgap\n</code></pre>"},{"location":"#quick-links","title":"Quick Links","text":"-   :rocket:{ .lg .middle } __Getting Started__      ---      Get up and running with K0rdentd in minutes      [:octicons-arrow-right-24: Installation](getting-started/installation.md)  -   :book:{ .lg .middle } __Architecture__      ---      Understand how K0rdentd works under the hood      [:octicons-arrow-right-24: Overview](architecture/overview.md)  -   :wrench:{ .lg .middle } __User Guide__      ---      Learn how to use all K0rdentd features      [:octicons-arrow-right-24: CLI Reference](user-guide/cli-reference.md)  -   :airplane:{ .lg .middle } __Airgap Installation__      ---      Install K0rdent in offline environments      [:octicons-arrow-right-24: Airgap Guide](user-guide/airgap-installation.md)"},{"location":"#project-status","title":"Project Status","text":"<p>K0rdentd is under active development. Current version: v0.2.0</p>"},{"location":"#build-flavors","title":"Build Flavors","text":"Flavor Description Binary Size Online Downloads k0s and k0rdent from internet ~60 MB Airgap Embeds k0s binary, uses external bundle ~300 MB"},{"location":"#contributing","title":"Contributing","text":"<p>We welcome contributions! See our Contributing Guide for details.</p>"},{"location":"#license","title":"License","text":"<p>K0rdentd is open source software licensed under the Apache License 2.0.</p>"},{"location":"#support","title":"Support","text":"<ul> <li>GitHub Issues: belgaied2/k0rdentd/issues</li> <li>Documentation: You're reading it!</li> <li>K0rdent Docs: docs.k0rdent.io</li> </ul>"},{"location":"airgap/airgap/","title":"Airgap Support","text":"<p>K0rdentd provides full support for airgap (offline) installations, allowing you to deploy K0s and K0rdent in environments without internet access.</p>"},{"location":"airgap/airgap/#overview","title":"Overview","text":""},{"location":"airgap/airgap/#build-flavors","title":"Build Flavors","text":"Flavor Description Binary Size Use Case Online Downloads K0s and K0rdent from internet ~60 MB Standard installations Airgap Embeds K0s binary, uses external bundle ~300 MB Offline installations"},{"location":"airgap/airgap/#whats-embedded","title":"What's Embedded","text":"<p>The airgap binary includes:</p> <ul> <li>K0s binary (~100 MB) - Embedded directly</li> <li>Skopeo binary (~40 MB) - For image pushing</li> </ul>"},{"location":"airgap/airgap/#whats-external","title":"What's External","text":"<p>The K0rdent Enterprise Airgap Bundle (downloaded separately):</p> <ul> <li>Size: ~22 GB (compressed)</li> <li>Contents: 233 OCI images, 83 Helm charts</li> <li>Source: Mirantis download portal</li> </ul>"},{"location":"airgap/airgap/#registry-daemon","title":"Registry Daemon","text":"<p>The registry daemon is a key component for airgap installations.</p>"},{"location":"airgap/airgap/#starting-the-daemon","title":"Starting the Daemon","text":"<pre><code>sudo k0rdentd registry \\\n  --bundle-path /opt/k0rdent/airgap-bundle-1.2.2.tar.gz \\\n  --port 5000 \\\n  --storage /var/lib/k0rdentd/registry\n</code></pre>"},{"location":"airgap/airgap/#configuration-options","title":"Configuration Options","text":"Flag Default Description <code>--bundle-path, -b</code> (required) Path to airgap bundle <code>--port, -p</code> 5000 Registry port <code>--host</code> 0.0.0.0 Host to bind to <code>--storage, -s</code> /var/lib/k0rdentd/registry Storage directory <code>--verify</code> false Verify bundle signature <code>--cosignKey</code> - Cosign public key URL/path"},{"location":"airgap/airgap/#containerd-mirror-configuration","title":"Containerd Mirror Configuration","text":"<p>For airgap mode, containerd is configured to use the local registry as a mirror.</p>"},{"location":"airgap/airgap/#directory-structure","title":"Directory Structure","text":"<pre><code>/etc/k0s/\n\u251c\u2500\u2500 k0s.yaml                           # k0s cluster configuration\n\u2514\u2500\u2500 containerd.d/                      # Drop-in configuration directory\n    \u251c\u2500\u2500 cri-registry.toml              # Containerd CRI registry config\n    \u2514\u2500\u2500 certs.d/                       # Registry hosts configuration\n        \u251c\u2500\u2500 registry.k8s.io/\n        \u2502   \u2514\u2500\u2500 hosts.toml             # Mirror config for registry.k8s.io\n        \u2514\u2500\u2500 quay.io/\n            \u2514\u2500\u2500 hosts.toml             # Mirror config for quay.io\n</code></pre>"},{"location":"airgap/airgap/#multi-worker-support","title":"Multi-Worker Support","text":"<p>Workers must be configured to use the bootstrap node's registry:</p> <pre><code>BOOTSTRAP_IP=\"192.168.1.10\"\n\nsudo mkdir -p /etc/k0s/containerd.d/certs.d/registry.k8s.io\ncat &lt;&lt;EOF | sudo tee /etc/k0s/containerd.d/certs.d/registry.k8s.io/hosts.toml\nserver = \"https://registry.k8s.io\"\n[host.\"http://${BOOTSTRAP_IP}:5000\"]\n  capabilities = [\"pull\", \"resolve\"]\nEOF\n</code></pre>"},{"location":"airgap/airgap/#building-airgap-binary","title":"Building Airgap Binary","text":"<pre><code># Build airgap binary (downloads K0s and Skopeo)\nmake build-airgap\n\n# Binary location\nls bin/k0rdentd-airgap\n</code></pre>"},{"location":"airgap/airgap/#see-also","title":"See Also","text":"<ul> <li>Airgap Installation Guide - Step-by-step installation</li> <li>Bundle Catalog - Complete bundle contents</li> </ul>"},{"location":"airgap/bundle-catalog/","title":"K0rdent Enterprise Airgap Bundle Catalog","text":"<p>This document describes the contents of the K0rdent Enterprise Airgap Bundle.</p>"},{"location":"airgap/bundle-catalog/#bundle-overview","title":"Bundle Overview","text":"Property Value Bundle <code>airgap-bundle-1.2.3.tar.gz</code> Source https://get.mirantis.com/k0rdent-enterprise/1.2.3/airgap-bundle-1.2.3.tar.gz Download Size 21 GB (compressed) Extracted Size 22 GB Total Images 233 files"},{"location":"airgap/bundle-catalog/#bundle-structure","title":"Bundle Structure","text":"<pre><code>airgap-bundle-1.2.3/\n\u251c\u2500\u2500 charts/                    # Helm charts (83 .tar files)\n\u251c\u2500\u2500 capi/                      # Cluster API provider images\n\u251c\u2500\u2500 k0sproject/                # K0s component images\n\u251c\u2500\u2500 provider-aws/              # AWS cloud provider\n\u251c\u2500\u2500 provider-os/               # OpenStack cloud provider\n\u251c\u2500\u2500 metrics-server/            # Metrics server images\n\u251c\u2500\u2500 opencost/                  # OpenCost images\n\u251c\u2500\u2500 opentelemetry-operator/    # OpenTelemetry images\n\u2514\u2500\u2500 [40+ vendor directories]   # Other component images\n</code></pre>"},{"location":"airgap/bundle-catalog/#helm-charts","title":"Helm Charts","text":""},{"location":"airgap/bundle-catalog/#core-k0rdent-charts","title":"Core K0rdent Charts","text":"Chart Version Size k0rdent-enterprise 1.2.3 558 KB kcm-regional 1.2.3 348 KB kcm-templates 1.2.3 10 KB k0rdent-ui 1.1.1 13 KB"},{"location":"airgap/bundle-catalog/#cluster-api-providers","title":"Cluster API Providers","text":""},{"location":"airgap/bundle-catalog/#aws","title":"AWS","text":"<ul> <li>aws-eks (1.0.4)</li> <li>aws-hosted-cp (1.0.21)</li> <li>aws-standalone-cp (1.0.20)</li> </ul>"},{"location":"airgap/bundle-catalog/#azure","title":"Azure","text":"<ul> <li>azure-aks (1.0.1)</li> <li>azure-hosted-cp (1.0.22)</li> <li>azure-standalone-cp (1.0.19)</li> </ul>"},{"location":"airgap/bundle-catalog/#gcp","title":"GCP","text":"<ul> <li>gcp-gke (1.0.6)</li> <li>gcp-hosted-cp (1.0.19)</li> <li>gcp-standalone-cp (1.0.17)</li> </ul>"},{"location":"airgap/bundle-catalog/#vsphere","title":"vSphere","text":"<ul> <li>vsphere-hosted-cp (1.0.18)</li> <li>vsphere-standalone-cp (1.0.17)</li> </ul>"},{"location":"airgap/bundle-catalog/#openstack","title":"OpenStack","text":"<ul> <li>openstack-hosted-cp (1.0.12)</li> <li>openstack-standalone-cp (1.0.21)</li> </ul>"},{"location":"airgap/bundle-catalog/#k0smotron","title":"K0smotron","text":"<ul> <li>cluster-api-provider-k0sproject-k0smotron (1.0.12)</li> </ul>"},{"location":"airgap/bundle-catalog/#observability-stack","title":"Observability Stack","text":"<ul> <li>OpenCost (2.4.0)</li> <li>OpenTelemetry Operator (0.84.2, 0.98.0)</li> <li>OpenTelemetry Kube Stack (0.5.3)</li> <li>Prometheus Operator CRDs (15.0.0)</li> <li>Grafana Operator (v5.18.0)</li> <li>VictoriaMetrics Operator (0.43.1)</li> <li>Jaeger Operator (2.50.1)</li> </ul>"},{"location":"airgap/bundle-catalog/#networking","title":"Networking","text":"<ul> <li>Ingress NGINX (4.12.1)</li> <li>Istio (1.25.3)</li> <li>Kube-VIP (0.6.1)</li> <li>External-DNS (1.15.2)</li> </ul>"},{"location":"airgap/bundle-catalog/#security","title":"Security","text":"<ul> <li>Cert-Manager (v1.16.4, v1.19.1)</li> <li>Dex (0.23.0)</li> <li>RBAC Manager (1.21.2)</li> </ul>"},{"location":"airgap/bundle-catalog/#backup","title":"Backup","text":"<ul> <li>Velero (11.0.0)</li> </ul>"},{"location":"airgap/bundle-catalog/#gitops","title":"GitOps","text":"<ul> <li>Flux2 (2.16.4)</li> </ul>"},{"location":"airgap/bundle-catalog/#container-images","title":"Container Images","text":""},{"location":"airgap/bundle-catalog/#cluster-api-controllers","title":"Cluster API Controllers","text":"Image Version Size cluster-api-controller v1.11.2 191 MB cluster-api-aws-controller v2.10.0 354 MB cluster-api-azure-controller v1.21.0 265 MB cluster-api-gcp-controller v1.10.0 254 MB cluster-api-vsphere-controller v1.14.0 204 MB capi-openstack-controller v0.12.5 166 MB k0smotron v1.10.0 86 MB"},{"location":"airgap/bundle-catalog/#k0s-components","title":"K0s Components","text":"Image Version Purpose k0s v1.32.8-k0s.0 Main K0s binary etcd v3.5.13 etcd datastore coredns 1.12.2 DNS service kube-proxy v1.32.8 Network proxy calico-node v3.29.4-0 Calico CNI calico-cni v3.29.4-0 Calico CNI plugin"},{"location":"airgap/bundle-catalog/#observability-images","title":"Observability Images","text":"<ul> <li>Metrics Server (v0.7.2)</li> <li>OpenCost (1.118.0)</li> <li>OpenTelemetry Collector (various)</li> <li>Prometheus components</li> <li>Grafana components</li> <li>Jaeger components</li> <li>VictoriaMetrics components</li> </ul>"},{"location":"airgap/bundle-catalog/#whats-included","title":"What's Included","text":""},{"location":"airgap/bundle-catalog/#included","title":"\u2705 Included","text":"<ul> <li>All Cluster API infrastructure providers</li> <li>All Helm chart dependencies</li> <li>All observability stack components</li> <li>K0s container images</li> <li>CSI drivers for all providers</li> </ul>"},{"location":"airgap/bundle-catalog/#not-included","title":"\u274c Not Included","text":"<ul> <li>K0s binary executable - Must be downloaded separately</li> <li>Embedded in k0rdentd-airgap binary</li> <li>Or downloaded from K0s releases</li> </ul>"},{"location":"airgap/bundle-catalog/#downloading-the-bundle","title":"Downloading the Bundle","text":"<pre><code># Set version\nK0RDENT_VERSION=\"1.2.2\"\n\n# Download\ncurl -L \"https://get.mirantis.com/k0rdent-enterprise/${K0RDENT_VERSION}/airgap-bundle-${K0RDENT_VERSION}.tar.gz\" -o airgap-bundle.tar.gz\n</code></pre>"},{"location":"airgap/bundle-catalog/#verifying-the-bundle","title":"Verifying the Bundle","text":"<pre><code># With cosign\ncosign verify-blob \\\n  --key https://get.mirantis.com/cosign.pub \\\n  --signature airgap-bundle-1.2.2.tar.gz.sig \\\n  airgap-bundle-1.2.2.tar.gz\n</code></pre>"},{"location":"airgap/bundle-catalog/#using-with-k0rdentd","title":"Using with K0rdentd","text":"<pre><code># Start registry with bundle\nsudo k0rdentd registry --bundle-path /path/to/airgap-bundle.tar.gz\n\n# Install K0rdent\nsudo k0rdentd install\n</code></pre>"},{"location":"airgap/bundle-catalog/#references","title":"References","text":"<ul> <li>Airgap Installation Guide</li> <li>Airgap Feature Documentation</li> <li>K0rdent Enterprise Documentation</li> </ul>"},{"location":"airgap/containerd-mirror/","title":"Containerd Registry Mirror","text":"<p>For airgap installations, K0rdentd configures containerd to use the local registry as a mirror for external registries.</p>"},{"location":"airgap/containerd-mirror/#overview","title":"Overview","text":"<p>When K0s starts in airgap mode, its underlying containerd runtime attempts to pull system images from internet registries (<code>registry.k8s.io</code>, <code>quay.io</code>). Since the airgap environment has no internet access, these pulls would fail.</p> <p>The solution is to configure containerd to use the local registry as a mirror.</p>"},{"location":"airgap/containerd-mirror/#architecture","title":"Architecture","text":""},{"location":"airgap/containerd-mirror/#directory-structure","title":"Directory Structure","text":"<pre><code>/etc/k0s/\n\u251c\u2500\u2500 k0s.yaml                           # k0s cluster configuration (existing)\n\u251c\u2500\u2500 containerd.toml                    # Generated by k0s (managed by k0s)\n\u2514\u2500\u2500 containerd.d/                      # Drop-in configuration directory\n    \u251c\u2500\u2500 cri-registry.toml              # Containerd CRI registry config (NEW)\n    \u2514\u2500\u2500 certs.d/                       # Registry hosts configuration (NEW)\n        \u251c\u2500\u2500 registry.k8s.io/\n        \u2502   \u2514\u2500\u2500 hosts.toml             # Mirror config for registry.k8s.io\n        \u2514\u2500\u2500 quay.io/\n            \u2514\u2500\u2500 hosts.toml             # Mirror config for quay.io\n</code></pre>"},{"location":"airgap/containerd-mirror/#configuration-files","title":"Configuration Files","text":""},{"location":"airgap/containerd-mirror/#cri-registrytoml","title":"cri-registry.toml","text":"<p>Tells containerd to look for registry-specific configuration:</p> <pre><code>version = 2\n\n[plugins.\"io.containerd.grpc.v1.cri\".registry]\nconfig_path = \"/etc/k0s/containerd.d/certs.d\"\n</code></pre>"},{"location":"airgap/containerd-mirror/#hoststoml-per-registry","title":"hosts.toml (per registry)","text":"<p>Configures the local registry as a mirror:</p> <pre><code>server = \"https://registry.k8s.io\"\n\n[host.\"http://127.0.0.1:5000\"]\n  capabilities = [\"pull\", \"resolve\"]\n</code></pre>"},{"location":"airgap/containerd-mirror/#implementation","title":"Implementation","text":""},{"location":"airgap/containerd-mirror/#setup-function","title":"Setup Function","text":"<pre><code>// SetupContainerdMirror configures containerd to use the local registry as mirror\nfunc SetupContainerdMirror(mirrorAddr string) error {\n    // Create directories\n    if err := os.MkdirAll(CertsDir, 0755); err != nil {\n        return fmt.Errorf(\"failed to create certs.d directory: %w\", err)\n    }\n\n    // Write CRI registry config\n    if err := os.WriteFile(CRIRegistryConfigPath, []byte(CRIRegistryConfig()), 0644); err != nil {\n        return fmt.Errorf(\"failed to write CRI registry config: %w\", err)\n    }\n\n    // Configure mirrors for known registries\n    registries := []string{\"registry.k8s.io\", \"quay.io\"}\n    for _, registry := range registries {\n        regDir := filepath.Join(CertsDir, registry)\n        if err := os.MkdirAll(regDir, 0755); err != nil {\n            return fmt.Errorf(\"failed to create registry dir for %s: %w\", registry, err)\n        }\n\n        hostsPath := filepath.Join(regDir, \"hosts.toml\")\n        hostsContent := HostsConfig(registry, mirrorAddr)\n        if err := os.WriteFile(hostsPath, []byte(hostsContent), 0644); err != nil {\n            return fmt.Errorf(\"failed to write hosts.toml for %s: %w\", registry, err)\n        }\n    }\n\n    return nil\n}\n</code></pre>"},{"location":"airgap/containerd-mirror/#timing","title":"Timing","text":"<p>The containerd configuration must be in place before K0s starts:</p> <ol> <li>Extract K0s binary to <code>/usr/local/bin/k0s</code></li> <li>Configure containerd registry mirror</li> <li>Write K0s configuration to <code>/etc/k0s/k0s.yaml</code></li> <li>Run <code>k0s install controller --enable-worker</code></li> <li>Start K0s service</li> </ol>"},{"location":"airgap/containerd-mirror/#supported-registries","title":"Supported Registries","text":"Registry Purpose <code>registry.k8s.io</code> Kubernetes system images <code>quay.io</code> K0s components (Calico, metrics-server) <code>docker.io</code> Third-party images (optional) <code>gcr.io</code> Google Container Registry images (optional)"},{"location":"airgap/containerd-mirror/#multi-worker-configuration","title":"Multi-Worker Configuration","text":"<p>For multi-worker clusters, use the bootstrap node's reachable IP:</p> <pre><code># For multi-worker: use reachable IP instead of localhost\n[host.\"http://192.168.1.10:5000\"]\n  capabilities = [\"pull\", \"resolve\"]\n</code></pre>"},{"location":"airgap/containerd-mirror/#worker-node-setup","title":"Worker Node Setup","text":"<p>On worker nodes:</p> <pre><code>BOOTSTRAP_IP=\"192.168.1.10\"\n\nsudo mkdir -p /etc/k0s/containerd.d/certs.d/registry.k8s.io\nsudo mkdir -p /etc/k0s/containerd.d/certs.d/quay.io\n\ncat &lt;&lt;EOF | sudo tee /etc/k0s/containerd.d/certs.d/registry.k8s.io/hosts.toml\nserver = \"https://registry.k8s.io\"\n[host.\"http://${BOOTSTRAP_IP}:5000\"]\n  capabilities = [\"pull\", \"resolve\"]\nEOF\n\ncat &lt;&lt;EOF | sudo tee /etc/k0s/containerd.d/certs.d/quay.io/hosts.toml\nserver = \"https://quay.io\"\n[host.\"http://${BOOTSTRAP_IP}:5000\"]\n  capabilities = [\"pull\", \"resolve\"]\nEOF\n</code></pre>"},{"location":"airgap/containerd-mirror/#verification","title":"Verification","text":"<p>After K0s starts, verify the configuration:</p> <pre><code># Check containerd configuration\ncat /etc/k0s/containerd.d/cri-registry.toml\n\n# Check registry hosts\ncat /etc/k0s/containerd.d/certs.d/quay.io/hosts.toml\ncat /etc/k0s/containerd.d/certs.d/registry.k8s.io/hosts.toml\n\n# Verify images are pulled from local registry\nsudo k0s kubectl get pods -A\n# All pods should be running without image pull errors\n</code></pre>"},{"location":"airgap/containerd-mirror/#troubleshooting","title":"Troubleshooting","text":""},{"location":"airgap/containerd-mirror/#image-pull-errors","title":"Image Pull Errors","text":"<p>Symptom: Pods stuck in ImagePullBackOff.</p> <p>Solution:</p> <pre><code># Verify mirror configuration\ncat /etc/k0s/containerd.d/certs.d/quay.io/hosts.toml\n\n# Verify registry is accessible\ncurl http://localhost:5000/v2/_catalog\n\n# Restart K0s to pick up configuration\nsudo k0s restart\n</code></pre>"},{"location":"airgap/containerd-mirror/#configuration-not-applied","title":"Configuration Not Applied","text":"<p>Symptom: Configuration exists but images still fail.</p> <p>Solution:</p> <pre><code># Check K0s logs\nsudo journalctl -u k0scontroller -f\n\n# Verify containerd picked up config\nsudo k0s kubectl get nodes\n</code></pre>"},{"location":"airgap/containerd-mirror/#references","title":"References","text":"<ul> <li>K0s Runtime Documentation</li> <li>K0s Airgap Installation</li> <li>Containerd Registry Configuration</li> </ul>"},{"location":"architecture/components/","title":"Components","text":"<p>This document describes the key components of K0rdentd in detail.</p>"},{"location":"architecture/components/#cli-package-pkgcli","title":"CLI Package (<code>pkg/cli</code>)","text":"<p>The CLI package implements all command-line commands using urfave/cli.</p>"},{"location":"architecture/components/#commands","title":"Commands","text":"Command File Description <code>install</code> <code>install.go</code> Install K0s and K0rdent <code>uninstall</code> <code>uninstall.go</code> Uninstall K0s and K0rdent <code>version</code> <code>version.go</code> Show version information <code>config</code> <code>config.go</code> Manage configuration <code>expose-ui</code> <code>expose_ui.go</code> Expose K0rdent UI <code>registry</code> <code>registry.go</code> Start OCI registry daemon <code>export-worker-artifacts</code> <code>export_worker.go</code> Export worker artifacts <code>show-flavor</code> <code>show_flavor.go</code> Show build flavor"},{"location":"architecture/components/#cli-flags","title":"CLI Flags","text":"Flag Description <code>--config-file</code> Path to config file (default: /etc/k0rdentd/k0rdentd.yaml) <code>--debug</code> Enable debug logging <code>--dry-run</code> Show what would be done without making changes"},{"location":"architecture/components/#config-package-pkgconfig","title":"Config Package (<code>pkg/config</code>)","text":"<p>The config package handles configuration parsing and validation.</p>"},{"location":"architecture/components/#configuration-types","title":"Configuration Types","text":"<pre><code>// K0rdentdConfig represents the complete k0rdentd configuration\ntype K0rdentdConfig struct {\n    K0s      K0sConfig      `yaml:\"k0s\"`\n    K0rdent  K0rdentConfig  `yaml:\"k0rdent\"`\n    Airgap   AirgapConfig   `yaml:\"airgap,omitempty\"`\n    Debug    bool           `yaml:\"debug\"`\n    LogLevel string         `yaml:\"logLevel\"`\n}\n\n// K0sConfig represents K0s-specific configuration\ntype K0sConfig struct {\n    Version string         `yaml:\"version\"`\n    API     APIConfig      `yaml:\"api\"`\n    Network NetworkConfig  `yaml:\"network\"`\n    Storage StorageConfig  `yaml:\"storage\"`\n}\n\n// K0rdentConfig represents K0rdent-specific configuration\ntype K0rdentConfig struct {\n    Version     string              `yaml:\"version\"`\n    Helm        K0rdentHelmConfig   `yaml:\"helm\"`\n    Credentials CredentialsConfig   `yaml:\"credentials,omitempty\"`\n}\n</code></pre>"},{"location":"architecture/components/#validation","title":"Validation","text":"<p>The config package validates:</p> <ul> <li>Required fields are present</li> <li>Version formats are correct</li> <li>Network CIDRs are valid</li> <li>File paths exist</li> </ul>"},{"location":"architecture/components/#generator-package-pkggenerator","title":"Generator Package (<code>pkg/generator</code>)","text":"<p>The generator package generates K0s configuration from k0rdentd configuration.</p>"},{"location":"architecture/components/#k0s-configuration-generation","title":"K0s Configuration Generation","text":"<pre><code>// GenerateK0sConfig generates k0s.yaml from k0rdentd configuration\nfunc GenerateK0sConfig(cfg *config.K0rdentdConfig) ([]byte, error)\n</code></pre> <p>The generator:</p> <ol> <li>Reads k0rdentd.yaml configuration</li> <li>Maps configuration to K0s format</li> <li>Adds Helm extension for K0rdent</li> <li>Generates valid k0s.yaml</li> </ol>"},{"location":"architecture/components/#installer-package-pkginstaller","title":"Installer Package (<code>pkg/installer</code>)","text":"<p>The installer package handles the installation workflow.</p>"},{"location":"architecture/components/#installation-steps","title":"Installation Steps","text":"<pre><code>graph TD\n    A[Start] --&gt; B[Check K0s Binary]\n    B --&gt; C[Generate K0s Config]\n    C --&gt; D[Install K0s]\n    D --&gt; E[Start K0s]\n    E --&gt; F[Wait for K0s Ready]\n    F --&gt; G[Create K8s Client]\n    G --&gt; H[Wait for K0rdent]\n    H --&gt; I{Credentials?}\n    I --&gt;|Yes| J[Create Credentials]\n    I --&gt;|No| K[Expose UI]\n    J --&gt; K\n    K --&gt; L[Complete]</code></pre>"},{"location":"architecture/components/#key-methods","title":"Key Methods","text":"Method Description <code>Install()</code> Main installation entry point <code>installK0s()</code> Install K0s binary <code>generateK0sConfig()</code> Generate K0s configuration <code>waitForK0sReady()</code> Wait for K0s to be ready <code>waitForK0rdentInstalled()</code> Wait for K0rdent pods <code>createCredentials()</code> Create cloud credentials"},{"location":"architecture/components/#k8sclient-package-pkgk8sclient","title":"K8sClient Package (<code>pkg/k8sclient</code>)","text":"<p>The k8sclient package provides a Kubernetes client wrapper.</p>"},{"location":"architecture/components/#client-structure","title":"Client Structure","text":"<pre><code>// Client wraps a Kubernetes clientset with helper methods\ntype Client struct {\n    clientset     kubernetes.Interface\n    dynamicClient dynamic.Interface\n    config        *rest.Config\n}\n</code></pre>"},{"location":"architecture/components/#key-methods_1","title":"Key Methods","text":"Method Description <code>NewFromK0s()</code> Create client from K0s kubeconfig <code>NewFromKubeconfig()</code> Create client from kubeconfig bytes <code>NamespaceExists()</code> Check namespace existence <code>GetDeploymentReadyReplicas()</code> Get ready replicas <code>GetPodPhases()</code> Get pod phases <code>PatchServiceType()</code> Patch service type <code>ApplyIngress()</code> Create/update ingress <code>CreateSecret()</code> Create Kubernetes secret <code>CreateAWSClusterStaticIdentity()</code> Create AWS identity <code>CreateAzureClusterIdentity()</code> Create Azure identity <code>CreateCredential()</code> Create K0rdent credential"},{"location":"architecture/components/#credentials-package-pkgcredentials","title":"Credentials Package (<code>pkg/credentials</code>)","text":"<p>The credentials package manages cloud provider credentials.</p>"},{"location":"architecture/components/#manager-structure","title":"Manager Structure","text":"<pre><code>// Manager handles creation of cloud provider credentials\ntype Manager struct {\n    client *k8sclient.Client\n}\n\n// NewManager creates a new credentials manager\nfunc NewManager(client *k8sclient.Client) *Manager\n</code></pre>"},{"location":"architecture/components/#supported-providers","title":"Supported Providers","text":""},{"location":"architecture/components/#aws","title":"AWS","text":"<p>Creates:</p> <ol> <li>Secret with AWS credentials</li> <li>AWSClusterStaticIdentity for CAPI</li> <li>Credential for K0rdent</li> </ol>"},{"location":"architecture/components/#azure","title":"Azure","text":"<p>Creates:</p> <ol> <li>Secret with Azure credentials</li> <li>AzureClusterIdentity for CAPI</li> <li>Credential for K0rdent</li> </ol>"},{"location":"architecture/components/#openstack","title":"OpenStack","text":"<p>Creates:</p> <ol> <li>Secret with clouds.yaml</li> <li>Credential for K0rdent</li> </ol>"},{"location":"architecture/components/#idempotency","title":"Idempotency","text":"<p>The credentials package implements idempotent resource creation:</p> <pre><code>// createIfNotExists checks for resource existence before creation\nfunc (m *Manager) createIfNotExists(\n    ctx context.Context,\n    spec ResourceSpec,\n    existsFn ExistsFunc,\n    createFn CreateFunc,\n) error\n</code></pre>"},{"location":"architecture/components/#k0s-package-pkgk0s","title":"K0s Package (<code>pkg/k0s</code>)","text":"<p>The k0s package manages the K0s binary.</p>"},{"location":"architecture/components/#checker","title":"Checker","text":"<pre><code>// CheckResult contains the result of a K0s check\ntype CheckResult struct {\n    Installed bool\n    Version   string\n    Path      string\n}\n\n// CheckK0s checks if K0s is installed and returns its version\nfunc CheckK0s() (CheckResult, error)\n\n// InstallK0s installs K0s using the official install script\nfunc InstallK0s() error\n</code></pre>"},{"location":"architecture/components/#ui-package-pkgui","title":"UI Package (<code>pkg/ui</code>)","text":"<p>The UI package handles exposing the K0rdent UI.</p>"},{"location":"architecture/components/#exposeui-flow","title":"ExposeUI Flow","text":"<pre><code>graph TD\n    A[Start] --&gt; B[Check UI Deployment]\n    B --&gt; C[Check UI Service]\n    C --&gt; D[Create Ingress]\n    D --&gt; E[Detect IPs]\n    E --&gt; F[Filter IPs]\n    F --&gt; G[Test Access]\n    G --&gt; H[Display URLs]</code></pre>"},{"location":"architecture/components/#ip-detection","title":"IP Detection","text":"<p>The UI package detects IPs from:</p> <ol> <li>Network interfaces (excluding Calico, Docker)</li> <li>Cloud metadata services (AWS, Azure, GCP)</li> <li>VPN interfaces (Tailscale, etc.)</li> </ol>"},{"location":"architecture/components/#airgap-package-internalairgap","title":"Airgap Package (<code>internal/airgap</code>)","text":"<p>The airgap package handles airgap-specific functionality.</p>"},{"location":"architecture/components/#detector","title":"Detector","text":"<pre><code>// Build flavor detection\nvar Flavor = \"online\"     // or \"airgap\"\nvar K0sVersion = \"\"       // Set at build time\n\nfunc IsAirGap() bool {\n    return Flavor == \"airgap\"\n}\n</code></pre>"},{"location":"architecture/components/#assets","title":"Assets","text":"<pre><code>//go:embed k0s/*\nvar K0sBinary embed.FS\n\n//go:embed skopeo/*\nvar SkopeoBinary embed.FS\n</code></pre>"},{"location":"architecture/components/#registry-daemon","title":"Registry Daemon","text":"<pre><code>// RegistryDaemon manages the local OCI registry\ntype RegistryDaemon struct {\n    port       string\n    host       string\n    storageDir string\n    bundlePath string\n    server     *http.Server\n}\n\nfunc (r *RegistryDaemon) Start(ctx context.Context) error\n</code></pre>"},{"location":"architecture/components/#containerd-configuration","title":"Containerd Configuration","text":"<pre><code>// SetupContainerdMirror configures containerd to use local registry\nfunc SetupContainerdMirror(mirrorAddr string) error\n</code></pre>"},{"location":"architecture/components/#utils-package-pkgutils","title":"Utils Package (<code>pkg/utils</code>)","text":"<p>The utils package provides utility functions.</p>"},{"location":"architecture/components/#logging","title":"Logging","text":"<pre><code>// GetLogger returns the configured logrus logger\nfunc GetLogger() *logrus.Logger\n</code></pre>"},{"location":"architecture/components/#spinner","title":"Spinner","text":"<pre><code>// Spinner displays a waiting spinner\ntype Spinner struct {\n    message string\n    active  bool\n}\n\nfunc NewSpinner(message string) *Spinner\nfunc (s *Spinner) Start()\nfunc (s *Spinner) Stop()\n</code></pre>"},{"location":"architecture/components/#testing-strategy","title":"Testing Strategy","text":""},{"location":"architecture/components/#unit-tests","title":"Unit Tests","text":"<ul> <li>Use ginkgo/gomega framework</li> <li>Mock external dependencies</li> <li>Test all business logic</li> </ul>"},{"location":"architecture/components/#test-coverage","title":"Test Coverage","text":"<ul> <li>Maintain &gt;80% code coverage</li> <li>Use fake clientset for K8sClient tests</li> <li>Mock exec commands for binary tests</li> </ul>"},{"location":"architecture/components/#integration-tests","title":"Integration Tests","text":"<ul> <li>Test with real K0s cluster</li> <li>Verify end-to-end installation</li> <li>Test upgrade scenarios</li> </ul>"},{"location":"architecture/overview/","title":"Architecture Overview","text":"<p>K0rdentd is a CLI tool that automates the deployment of K0s and K0rdent on a VM. It follows a similar pattern to RancherD but simplifies the architecture by directly configuring K0s and using its built-in Helm extension mechanism.</p>"},{"location":"architecture/overview/#high-level-architecture","title":"High-Level Architecture","text":"<pre><code>graph TD\n    A[User] --&gt;|CLI Commands| B[k0rdentd]\n    B --&gt;|Read Config| C[\"/etc/k0rdentd/k0rdent.yaml\"]\n    B --&gt;|Generate Config| D[\"/etc/k0s/k0s.yaml\"]\n    B --&gt;|Execute| E[k0s binary]\n    E --&gt;|Deploy| F[K0s Cluster]\n    E --&gt;|Helm Extension| G[K0rdent]\n    B -.-&gt;|Retrieve Kubeconfig| H[k8sclient]\n    H -.-&gt;|client-go| F</code></pre>"},{"location":"architecture/overview/#core-components","title":"Core Components","text":""},{"location":"architecture/overview/#1-cli-interface","title":"1. CLI Interface","text":"<p>The CLI is built using urfave/cli and provides the following commands:</p> Command Description <code>k0rdentd install</code> Install K0s and K0rdent <code>k0rdentd uninstall</code> Uninstall K0s and K0rdent <code>k0rdentd version</code> Show version information <code>k0rdentd config</code> Manage configuration <code>k0rdentd expose-ui</code> Expose K0rdent UI <code>k0rdentd registry</code> Start OCI registry daemon <code>k0rdentd export-worker-artifacts</code> Export artifacts for worker nodes <code>k0rdentd show-flavor</code> Show build flavor"},{"location":"architecture/overview/#2-configuration-management","title":"2. Configuration Management","text":"<p>K0rdentd reads configuration from <code>/etc/k0rdentd/k0rdentd.yaml</code> and generates:</p> <ul> <li>K0s configuration at <code>/etc/k0s/k0s.yaml</code></li> <li>Containerd configuration for airgap mode</li> <li>Helm values for K0rdent deployment</li> </ul>"},{"location":"architecture/overview/#3-k0s-binary-management","title":"3. K0s Binary Management","text":"<p>K0rdentd manages the K0s binary:</p> <ul> <li>Online mode: Downloads from official sources</li> <li>Airgap mode: Extracts from embedded binary</li> </ul>"},{"location":"architecture/overview/#4-kubernetes-client","title":"4. Kubernetes Client","text":"<p>Uses client-go to interact with the cluster:</p> <ul> <li>No dependency on kubectl binary</li> <li>Type-safe API operations</li> <li>Better error handling</li> </ul>"},{"location":"architecture/overview/#5-credentials-management","title":"5. Credentials Management","text":"<p>Creates cloud provider credentials for K0rdent:</p> <ul> <li>AWS: Secret + AWSClusterStaticIdentity + Credential</li> <li>Azure: Secret + AzureClusterIdentity + Credential</li> <li>OpenStack: Secret + Credential</li> </ul>"},{"location":"architecture/overview/#6-airgap-support","title":"6. Airgap Support","text":"<p>Full offline installation support:</p> <ul> <li>Embedded K0s binary</li> <li>Local OCI registry daemon</li> <li>Containerd mirror configuration</li> </ul>"},{"location":"architecture/overview/#design-principles","title":"Design Principles","text":""},{"location":"architecture/overview/#simplicity","title":"Simplicity","text":"<ul> <li>Single binary deployment</li> <li>Minimal external dependencies</li> <li>Clear configuration structure</li> </ul>"},{"location":"architecture/overview/#security","title":"Security","text":"<ul> <li>No secrets in logs</li> <li>Credentials stored in Kubernetes Secrets</li> <li>File permissions enforced</li> </ul>"},{"location":"architecture/overview/#reliability","title":"Reliability","text":"<ul> <li>Idempotent operations</li> <li>Graceful error handling</li> <li>Comprehensive logging</li> </ul>"},{"location":"architecture/overview/#directory-structure","title":"Directory Structure","text":"<pre><code>.\n\u251c\u2500\u2500 cmd/\n\u2502   \u2514\u2500\u2500 k0rdentd/\n\u2502       \u2514\u2500\u2500 main.go          # CLI entry point\n\u251c\u2500\u2500 pkg/\n\u2502   \u251c\u2500\u2500 cli/                # CLI command implementations\n\u2502   \u251c\u2500\u2500 config/             # Configuration management\n\u2502   \u251c\u2500\u2500 generator/          # K0s config generation\n\u2502   \u251c\u2500\u2500 installer/          # Installation logic\n\u2502   \u251c\u2500\u2500 credentials/        # Cloud provider credentials\n\u2502   \u251c\u2500\u2500 k8sclient/          # Kubernetes client-go wrapper\n\u2502   \u251c\u2500\u2500 k0s/                # K0s binary management\n\u2502   \u251c\u2500\u2500 ui/                 # UI exposure functionality\n\u2502   \u2514\u2500\u2500 utils/              # Utility functions\n\u251c\u2500\u2500 internal/\n\u2502   \u251c\u2500\u2500 airgap/             # Airgap-specific code\n\u2502   \u2502   \u251c\u2500\u2500 assets/         # Embedded assets\n\u2502   \u2502   \u251c\u2500\u2500 registry/       # OCI registry daemon\n\u2502   \u2502   \u251c\u2500\u2500 containerd/     # Containerd configuration\n\u2502   \u2502   \u2514\u2500\u2500 bundle/         # Bundle handling\n\u2502   \u2514\u2500\u2500 test/               # Test utilities\n\u251c\u2500\u2500 scripts/                # Build and deployment scripts\n\u251c\u2500\u2500 docs/                   # Documentation\n\u2514\u2500\u2500 examples/               # Example configurations\n</code></pre>"},{"location":"architecture/overview/#next-steps","title":"Next Steps","text":"<ul> <li>System Design - Detailed system design</li> <li>Components - Component documentation</li> </ul>"},{"location":"architecture/system-design/","title":"System Design","text":"<p>This document describes the detailed system design of K0rdentd.</p>"},{"location":"architecture/system-design/#installation-workflow","title":"Installation Workflow","text":"<pre><code>sequenceDiagram\n    participant User\n    participant CLI\n    participant Config\n    participant K0s\n    participant K8sClient\n    participant Helm\n\n    User-&gt;&gt;CLI: k0rdentd install\n    CLI-&gt;&gt;Config: Read /etc/k0rdentd/k0rdentd.yaml\n    Config--&gt;&gt;CLI: Configuration data\n    CLI-&gt;&gt;CLI: Generate /etc/k0s/k0s.yaml\n    CLI-&gt;&gt;K0s: Execute k0s install and k0s start\n    K0s-&gt;&gt;K0s: Wait for k0s status to be OK\n    CLI-&gt;&gt;K0s: Retrieve kubeconfig via k0s kubeconfig admin\n    K0s--&gt;&gt;CLI: Kubeconfig content\n    CLI-&gt;&gt;K8sClient: Create client from kubeconfig\n    K8sClient--&gt;&gt;CLI: Kubernetes clientset\n    CLI-&gt;&gt;K8sClient: Check namespace exists\n    K8sClient-&gt;&gt;K0s: API call\n    K0s-&gt;&gt;Helm: Install k0rdent via helm extension\n    Helm-&gt;&gt;Helm: Wait for Helm install to be OK\n    CLI-&gt;&gt;K8sClient: Check deployments ready\n    K8sClient-&gt;&gt;K0s: API call\n    Helm--&gt;&gt;K0s: Installation complete\n    K0s--&gt;&gt;CLI: Installation complete\n    CLI--&gt;&gt;User: Success</code></pre>"},{"location":"architecture/system-design/#configuration-flow","title":"Configuration Flow","text":""},{"location":"architecture/system-design/#k0rdentd-configuration-to-k0s-configuration","title":"K0rdentd Configuration to K0s Configuration","text":"<p>K0rdentd translates the user-friendly configuration in <code>/etc/k0rdentd/k0rdentd.yaml</code> to K0s-specific configuration at <code>/etc/k0s/k0s.yaml</code>:</p> <pre><code>graph LR\n    A[k0rdentd.yaml] --&gt; B[Config Parser]\n    B --&gt; C[K0s Config Generator]\n    C --&gt; D[k0s.yaml]\n    D --&gt; E[K0s Cluster]</code></pre>"},{"location":"architecture/system-design/#configuration-mapping","title":"Configuration Mapping","text":"k0rdentd.yaml k0s.yaml <code>k0s.api.address</code> <code>spec.api.address</code> <code>k0s.api.port</code> <code>spec.api.port</code> <code>k0s.network.provider</code> <code>spec.network.provider</code> <code>k0s.network.podCIDR</code> <code>spec.network.podCIDR</code> <code>k0s.network.serviceCIDR</code> <code>spec.network.serviceCIDR</code> <code>k0s.storage.type</code> <code>spec.storage.type</code> <code>k0rdent.version</code> <code>spec.extensions.helm.charts[].version</code> <code>k0rdent.helm.values</code> <code>spec.extensions.helm.charts[].values</code>"},{"location":"architecture/system-design/#kubernetes-client-architecture","title":"Kubernetes Client Architecture","text":""},{"location":"architecture/system-design/#k8sclient-package","title":"K8sClient Package","text":"<p>The <code>k8sclient</code> package provides a Go-native way to interact with the Kubernetes cluster using the official <code>client-go</code> library.</p> <pre><code>// Client wraps a Kubernetes clientset with helper methods\ntype Client struct {\n    clientset kubernetes.Interface\n    config    *rest.Config\n}\n</code></pre>"},{"location":"architecture/system-design/#kubeconfig-retrieval","title":"Kubeconfig Retrieval","text":"<ol> <li>After K0s installation, retrieve admin kubeconfig via <code>k0s kubeconfig admin</code></li> <li>Keep kubeconfig in memory (not written to disk) for security</li> <li>Create client-go clientset using <code>clientcmd.RESTConfigFromKubeConfig()</code></li> </ol>"},{"location":"architecture/system-design/#provided-operations","title":"Provided Operations","text":"Method Description <code>NamespaceExists(name)</code> Check if namespace exists <code>GetDeploymentReadyReplicas(ns, name)</code> Get ready replica count <code>GetDeploymentReplicas(ns, name)</code> Get total replica count <code>GetPodPhases(ns, selector)</code> Get pod phases by selector <code>PatchServiceType(ns, name, type)</code> Patch service type <code>GetServiceNodePort(ns, name)</code> Get service NodePort <code>ApplyIngress(ingress)</code> Create or update ingress <code>GetDeploymentEnvVar(ns, dep, container, env)</code> Extract env var"},{"location":"architecture/system-design/#benefits","title":"Benefits","text":"<ul> <li>Type-safe API operations instead of jsonpath parsing</li> <li>Better error handling using <code>k8s.io/apimachinery/pkg/api/errors</code></li> <li>No dependency on kubectl binary</li> <li>Easier to mock for testing using fake clientset</li> </ul>"},{"location":"architecture/system-design/#credentials-package-architecture","title":"Credentials Package Architecture","text":""},{"location":"architecture/system-design/#manager-structure","title":"Manager Structure","text":"<pre><code>// Manager handles creation of cloud provider credentials\ntype Manager struct {\n    client *k8sclient.Client\n}\n</code></pre>"},{"location":"architecture/system-design/#credential-creation-flow","title":"Credential Creation Flow","text":"<pre><code>graph TD\n    A[User Config] --&gt;|Parse| B[CredentialsConfig]\n    B --&gt;|For each AWS cred| C{Secret Exists?}\n    C --&gt;|No| D[Create Secret]\n    C --&gt;|Yes| E[Skip Secret]\n    D --&gt; F{Identity Exists?}\n    E --&gt; F\n    F --&gt;|No| G[Create Identity]\n    F --&gt;|Yes| H[Skip Identity]\n    G --&gt; I{Credential Exists?}\n    H --&gt; I\n    I --&gt;|No| J[Create Credential]\n    I --&gt;|Yes| K[Skip Credential]</code></pre>"},{"location":"architecture/system-design/#idempotent-resource-creation","title":"Idempotent Resource Creation","text":"<p>The <code>createIfNotExists</code> function provides idempotent operations:</p> <pre><code>// ResourceSpec defines the specification of a resource to be created\ntype ResourceSpec struct {\n    Type      ResourceType\n    Namespace string\n    Name      string\n}\n\n// createIfNotExists checks for resource existence before creation\nfunc (m *Manager) createIfNotExists(\n    ctx context.Context,\n    spec ResourceSpec,\n    existsFn ExistsFunc,\n    createFn CreateFunc,\n) error\n</code></pre>"},{"location":"architecture/system-design/#error-handling-strategy","title":"Error Handling Strategy","text":"<ul> <li>Best effort approach: Secret creation failures return errors</li> <li>Graceful degradation: Identity/Credential failures only log warnings</li> <li>Partial state recovery: Can recover from interrupted runs</li> </ul>"},{"location":"architecture/system-design/#airgap-architecture","title":"Airgap Architecture","text":""},{"location":"architecture/system-design/#component-diagram","title":"Component Diagram","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                           Air-Gapped k0rdentd                               \u2502\n\u2502                                Binary                                        \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510     \u2502\n\u2502  \u2502   k0s Binary \u2502  \u2502              Build Metadata                     \u2502     \u2502\n\u2502  \u2502   (embedded) \u2502  \u2502  { \"flavor\": \"airgap\", \"k0sVersion\": \"v1.32.8\" }\u2502     \u2502\n\u2502  \u2502  ~100 MB     \u2502  \u2502                                               \u2502     \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518     \u2502\n\u2502                                                                              \u2502\n\u2502  External: k0rdent Enterprise Airgap Bundle (22 GB)                          \u2502\n\u2502  Source: https://get.mirantis.com/k0rdent-enterprise/VERSION/               \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                                   \u2502\n                                   \u25bc\n                     \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n                     \u2502   k0rdentd registry daemon   \u2502\n                     \u2502   (Separate Process)         \u2502\n                     \u2502   Port: 5000 (configurable)  \u2502\n                     \u2502   Storage: /var/lib/registry \u2502\n                     \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"architecture/system-design/#registry-daemon-lifecycle","title":"Registry Daemon Lifecycle","text":"<pre><code>flowchart TD\n    RegStart([Start: k0rdentd registry]) --&gt; LoadConfig[Load Config]\n    LoadConfig --&gt; VerifyBundle[Verify Bundle with cosign]\n    VerifyBundle --&gt; ExtractVersion[Extract k0rdent Version from Bundle]\n    ExtractVersion --&gt; InitRegistry[Initialize Registry Handler]\n    InitRegistry --&gt; PushImages[Push Images to Local Registry]\n    PushImages --&gt; RunServer[Run HTTP Server on Configurable Port]\n\n    RunServer --&gt; HandleRequests[Handle Registry API Requests]\n    HandleRequests --&gt; Running{Running?}\n    Running --&gt;|Yes| HandleRequests\n    Running --&gt;|No| GracefulShutdown[Graceful Shutdown]\n    GracefulShutdown --&gt; RegEnd([End])</code></pre>"},{"location":"architecture/system-design/#containerd-mirror-configuration","title":"Containerd Mirror Configuration","text":"<p>For airgap mode, containerd is configured to use the local registry:</p> <pre><code>/etc/k0s/\n\u251c\u2500\u2500 k0s.yaml                           # k0s cluster configuration\n\u2514\u2500\u2500 containerd.d/                      # Drop-in configuration directory\n    \u251c\u2500\u2500 cri-registry.toml              # Containerd CRI registry config\n    \u2514\u2500\u2500 certs.d/                       # Registry hosts configuration\n        \u251c\u2500\u2500 registry.k8s.io/\n        \u2502   \u2514\u2500\u2500 hosts.toml             # Mirror config for registry.k8s.io\n        \u2514\u2500\u2500 quay.io/\n            \u2514\u2500\u2500 hosts.toml             # Mirror config for quay.io\n</code></pre>"},{"location":"architecture/system-design/#security-considerations","title":"Security Considerations","text":""},{"location":"architecture/system-design/#input-validation","title":"Input Validation","text":"<ul> <li>All user inputs and configuration values are validated</li> <li>File paths are sanitized</li> <li>Network addresses are validated</li> </ul>"},{"location":"architecture/system-design/#sensitive-data-handling","title":"Sensitive Data Handling","text":"<ul> <li>No secrets or API keys are committed to the repository</li> <li>Credentials are never logged</li> <li>Kubeconfig is kept in memory, not written to disk</li> </ul>"},{"location":"architecture/system-design/#file-permissions","title":"File Permissions","text":"<ul> <li>Configuration files have appropriate permissions (600)</li> <li>K0s binary is installed with correct permissions</li> <li>Registry storage is protected</li> </ul>"},{"location":"architecture/system-design/#error-handling","title":"Error Handling","text":""},{"location":"architecture/system-design/#validation","title":"Validation","text":"<ul> <li>Configuration file structure and values</li> <li>Required dependencies (k0s binary, helm, etc.)</li> <li>File existence and permissions</li> </ul>"},{"location":"architecture/system-design/#error-messages","title":"Error Messages","text":"<ul> <li>Meaningful error messages with context</li> <li>Suggestions for remediation</li> <li>Debug logging for troubleshooting</li> </ul>"},{"location":"architecture/system-design/#dry-run-mode","title":"Dry-Run Mode","text":"<ul> <li>Test configuration without making changes</li> <li>Show what would be done</li> <li>Validate all inputs</li> </ul>"},{"location":"architecture/system-design/#next-steps","title":"Next Steps","text":"<ul> <li>Components - Detailed component documentation</li> </ul>"},{"location":"development/contributing/","title":"Contributing","text":"<p>Thank you for your interest in contributing to K0rdentd!</p>"},{"location":"development/contributing/#getting-started","title":"Getting Started","text":""},{"location":"development/contributing/#prerequisites","title":"Prerequisites","text":"<ul> <li>Go 1.21 or later</li> <li>Make</li> <li>Git</li> <li>curl (for downloading assets)</li> <li>sudo access (for testing)</li> </ul>"},{"location":"development/contributing/#fork-and-clone","title":"Fork and Clone","text":"<pre><code># Fork the repository on GitHub\n# Then clone your fork\ngit clone https://github.com/YOUR_USERNAME/k0rdentd.git\ncd k0rdentd\n\n# Add upstream remote\ngit remote add upstream https://github.com/belgaied2/k0rdentd.git\n</code></pre>"},{"location":"development/contributing/#build","title":"Build","text":"<pre><code># Build online flavor\nmake build\n\n# Build airgap flavor\nmake build-airgap\n</code></pre>"},{"location":"development/contributing/#test","title":"Test","text":"<pre><code># Run tests\nmake test\n\n# Run specific test\ngo test ./pkg/config/... -v\n</code></pre>"},{"location":"development/contributing/#development-workflow","title":"Development Workflow","text":""},{"location":"development/contributing/#1-create-a-branch","title":"1. Create a Branch","text":"<pre><code>git checkout -b feature/my-feature\n# or\ngit checkout -b bugfix/my-fix\n</code></pre>"},{"location":"development/contributing/#2-make-changes","title":"2. Make Changes","text":"<ul> <li>Write code</li> <li>Add tests</li> <li>Update documentation</li> </ul>"},{"location":"development/contributing/#3-test-your-changes","title":"3. Test Your Changes","text":"<pre><code># Run tests\nmake test\n\n# Build\nmake build\n\n# Test locally\nsudo ./bin/k0rdentd install\n</code></pre>"},{"location":"development/contributing/#4-commit","title":"4. Commit","text":"<p>We follow conventional commits:</p> <ul> <li><code>feat:</code> New feature</li> <li><code>fix:</code> Bug fix</li> <li><code>docs:</code> Documentation</li> <li><code>test:</code> Tests</li> <li><code>refactor:</code> Code refactoring</li> <li><code>chore:</code> Maintenance</li> </ul> <pre><code>git commit -m \"feat: add new feature\"\n</code></pre>"},{"location":"development/contributing/#5-push-and-create-pr","title":"5. Push and Create PR","text":"<pre><code>git push origin feature/my-feature\n</code></pre> <p>Then create a Pull Request on GitHub.</p>"},{"location":"development/contributing/#code-style","title":"Code Style","text":""},{"location":"development/contributing/#go","title":"Go","text":"<ul> <li>Follow Effective Go</li> <li>Use <code>gofmt</code> for formatting</li> <li>Use <code>goimports</code> for imports</li> </ul>"},{"location":"development/contributing/#logging","title":"Logging","text":"<p>Use logrus with appropriate levels:</p> <pre><code>// DEBUG: Intermediate steps\nutils.GetLogger().Debug(\"Checking k0s status\")\n\n// INFO: User-relevant events\nutils.GetLogger().Info(\"K0s installed successfully\")\n\n// WARN: Unexpected behavior\nutils.GetLogger().Warn(\"Credential creation failed, continuing\")\n\n// ERROR: Critical errors\nutils.GetLogger().Error(\"Failed to start k0s\")\n</code></pre>"},{"location":"development/contributing/#error-handling","title":"Error Handling","text":"<pre><code>if err != nil {\n    return fmt.Errorf(\"failed to do something: %w\", err)\n}\n</code></pre>"},{"location":"development/contributing/#testing","title":"Testing","text":""},{"location":"development/contributing/#unit-tests","title":"Unit Tests","text":"<p>Use ginkgo/gomega:</p> <pre><code>Describe(\"CheckK0s\", func() {\n    Context(\"when k0s is installed\", func() {\n        It(\"should return version\", func() {\n            result, err := CheckK0s()\n            Expect(err).NotTo(HaveOccurred())\n            Expect(result.Installed).To(BeTrue())\n        })\n    })\n})\n</code></pre>"},{"location":"development/contributing/#test-coverage","title":"Test Coverage","text":"<p>Maintain &gt;80% code coverage:</p> <pre><code>go test -coverprofile=coverage.out ./...\ngo tool cover -html=coverage.out\n</code></pre>"},{"location":"development/contributing/#documentation","title":"Documentation","text":""},{"location":"development/contributing/#code-comments","title":"Code Comments","text":"<pre><code>// CheckK0s checks if k0s is installed and returns its version.\n// It returns CheckResult with Installed=true if found, false otherwise.\nfunc CheckK0s() (CheckResult, error) {\n    // ...\n}\n</code></pre>"},{"location":"development/contributing/#readme-and-docs","title":"README and Docs","text":"<p>Update documentation for:</p> <ul> <li>New features</li> <li>Configuration changes</li> <li>CLI changes</li> <li>Bug fixes (if user-facing)</li> </ul>"},{"location":"development/contributing/#pull-request-guidelines","title":"Pull Request Guidelines","text":""},{"location":"development/contributing/#pr-title","title":"PR Title","text":"<p>Use conventional commit format:</p> <ul> <li><code>feat: add AWS credential support</code></li> <li><code>fix: correct image tag parsing</code></li> <li><code>docs: update installation guide</code></li> </ul>"},{"location":"development/contributing/#pr-description","title":"PR Description","text":"<p>Include:</p> <ol> <li>What: Description of changes</li> <li>Why: Motivation for changes</li> <li>How: Implementation details</li> <li>Testing: How to test</li> </ol>"},{"location":"development/contributing/#checklist","title":"Checklist","text":"<ul> <li> Tests pass</li> <li> Code is formatted</li> <li> Documentation updated</li> <li> Commit messages are clear</li> </ul>"},{"location":"development/contributing/#release-process","title":"Release Process","text":"<p>Releases are automated via GitHub Actions:</p> <ol> <li>Create and push a tag: <code>git tag v0.3.0 &amp;&amp; git push origin v0.3.0</code></li> <li>GitHub Actions builds and releases</li> <li>Update documentation</li> </ol>"},{"location":"development/contributing/#getting-help","title":"Getting Help","text":"<ul> <li>Issues: GitHub Issues</li> <li>Discussions: GitHub Discussions</li> </ul>"},{"location":"development/contributing/#license","title":"License","text":"<p>By contributing, you agree that your contributions will be licensed under the Apache License 2.0.</p>"},{"location":"development/release-process/","title":"Release Process","text":"<p>This document describes the release process for K0rdentd.</p>"},{"location":"development/release-process/#overview","title":"Overview","text":"<p>Releases are automated via GitHub Actions. When a tag is pushed, the workflow:</p> <ol> <li>Builds binaries for AMD64 and ARM64</li> <li>Creates online and airgap flavors</li> <li>Generates release notes</li> <li>Uploads artifacts to GitHub Releases</li> </ol>"},{"location":"development/release-process/#release-types","title":"Release Types","text":"Type Format Example Stable <code>vX.Y.Z</code> <code>v0.2.0</code> Pre-release <code>vX.Y.Z-rc.N</code> <code>v0.2.0-rc.1</code> Beta <code>vX.Y.Z-beta.N</code> <code>v0.2.0-beta.1</code>"},{"location":"development/release-process/#release-steps","title":"Release Steps","text":""},{"location":"development/release-process/#1-prepare-release","title":"1. Prepare Release","text":""},{"location":"development/release-process/#update-version","title":"Update Version","text":"<p>Update version in code if needed:</p> <pre><code>// pkg/cli/version.go\nvar Version = \"dev\"\n</code></pre> <p>Version is injected at build time via ldflags.</p>"},{"location":"development/release-process/#update-changelog","title":"Update Changelog","text":"<p>Create or update <code>CHANGELOG.md</code>:</p> <pre><code>## v0.2.0 (2024-01-15)\n\n### New Features\n- Add airgap installation support\n- Add cloud provider credentials\n\n### Bug Fixes\n- Fix K0rdent install check\n- Fix OCI registry image tags\n\n### Improvements\n- Improve error messages\n- Add more logging\n</code></pre>"},{"location":"development/release-process/#update-documentation","title":"Update Documentation","text":"<ul> <li>Update README.md if needed</li> <li>Update docs for new features</li> <li>Update installation guide</li> </ul>"},{"location":"development/release-process/#2-create-tag","title":"2. Create Tag","text":"<pre><code># Ensure you're on main\ngit checkout main\ngit pull origin main\n\n# Create tag\ngit tag v0.2.0\n\n# Push tag\ngit push origin v0.2.0\n</code></pre>"},{"location":"development/release-process/#3-monitor-workflow","title":"3. Monitor Workflow","text":"<ol> <li>Go to GitHub Actions</li> <li>Find the \"Release\" workflow</li> <li>Monitor progress</li> </ol>"},{"location":"development/release-process/#4-verify-release","title":"4. Verify Release","text":"<p>Once complete:</p> <ol> <li>Go to Releases</li> <li>Verify all artifacts are present:</li> <li><code>k0rdentd-v0.2.0-linux-amd64.tar.gz</code></li> <li><code>k0rdentd-v0.2.0-linux-arm64.tar.gz</code></li> <li><code>k0rdentd-airgap-v0.2.0-linux-amd64.tar.gz</code></li> <li><code>k0rdentd-airgap-v0.2.0-linux-arm64.tar.gz</code></li> <li>SHA256 checksums</li> <li>Verify release notes are correct</li> </ol>"},{"location":"development/release-process/#5-post-release","title":"5. Post-Release","text":""},{"location":"development/release-process/#announce","title":"Announce","text":"<ul> <li>Update GitHub release description</li> <li>Announce on relevant channels</li> </ul>"},{"location":"development/release-process/#update-documentation-site","title":"Update Documentation Site","text":"<pre><code># Build and deploy docs\nmkdocs build\nmkdocs deploy\n</code></pre>"},{"location":"development/release-process/#build-artifacts","title":"Build Artifacts","text":""},{"location":"development/release-process/#online-flavor","title":"Online Flavor","text":"Architecture Binary Archive AMD64 <code>k0rdentd</code> <code>k0rdentd-v0.2.0-linux-amd64.tar.gz</code> ARM64 <code>k0rdentd</code> <code>k0rdentd-v0.2.0-linux-arm64.tar.gz</code>"},{"location":"development/release-process/#airgap-flavor","title":"Airgap Flavor","text":"Architecture Binary Archive AMD64 <code>k0rdentd-airgap</code> <code>k0rdentd-airgap-v0.2.0-linux-amd64.tar.gz</code> ARM64 <code>k0rdentd-airgap</code> <code>k0rdentd-airgap-v0.2.0-linux-arm64.tar.gz</code>"},{"location":"development/release-process/#archive-contents","title":"Archive Contents","text":"<p>Each archive contains:</p> <ul> <li>Binary</li> <li><code>README.md</code></li> <li><code>LICENSE</code></li> </ul>"},{"location":"development/release-process/#rollback","title":"Rollback","text":"<p>If a release has critical issues:</p>"},{"location":"development/release-process/#1-mark-as-pre-release","title":"1. Mark as Pre-release","text":"<pre><code># Via GitHub UI or API\n# Edit release \u2192 Mark as pre-release\n</code></pre>"},{"location":"development/release-process/#2-delete-tag-if-needed","title":"2. Delete Tag (if needed)","text":"<pre><code># Delete local tag\ngit tag -d v0.2.0\n\n# Delete remote tag\ngit push origin :refs/tags/v0.2.0\n</code></pre>"},{"location":"development/release-process/#3-delete-release","title":"3. Delete Release","text":"<p>Via GitHub UI:</p> <ol> <li>Go to Releases</li> <li>Find the release</li> <li>Click Delete</li> </ol>"},{"location":"development/release-process/#4-fix-and-re-release","title":"4. Fix and Re-release","text":"<ol> <li>Fix the issue</li> <li>Create new tag (e.g., <code>v0.2.1</code>)</li> <li>Push tag</li> </ol>"},{"location":"development/release-process/#version-numbering","title":"Version Numbering","text":"<p>We follow Semantic Versioning:</p> <ul> <li>MAJOR: Incompatible API changes</li> <li>MINOR: New features, backward compatible</li> <li>PATCH: Bug fixes, backward compatible</li> </ul>"},{"location":"development/release-process/#examples","title":"Examples","text":"Version Change Type <code>v1.0.0</code> \u2192 <code>v2.0.0</code> Breaking changes <code>v1.0.0</code> \u2192 <code>v1.1.0</code> New features <code>v1.0.0</code> \u2192 <code>v1.0.1</code> Bug fixes"},{"location":"development/release-process/#release-notes-template","title":"Release Notes Template","text":"<pre><code>## K0rdentd v0.2.0\n\n### New Features\n\n- Feature 1\n- Feature 2\n\n### Bug Fixes\n\n- Fix 1\n- Fix 2\n\n### Improvements\n\n- Improvement 1\n- Improvement 2\n\n### Breaking Changes\n\n- Breaking change 1 (if any)\n\n### Installation\n\nInstallation instructions here.\n\n### Airgap Installation\n\nDownload the airgap build for offline installations.\n\n### Changelog\n\nSee [CHANGELOG.md](CHANGELOG.md) for full details.\n</code></pre>"},{"location":"development/release-process/#manual-release","title":"Manual Release","text":"<p>If GitHub Actions is unavailable:</p> <pre><code># Build all flavors\nmake build\nmake build-airgap\n\n# Create archives\ntar -czf k0rdentd-v0.2.0-linux-amd64.tar.gz k0rdentd README.md LICENSE\ntar -czf k0rdentd-airgap-v0.2.0-linux-amd64.tar.gz k0rdentd-airgap README.md LICENSE\n\n# Create checksums\nsha256sum *.tar.gz &gt; checksums.sha256\n\n# Upload manually via GitHub UI\n</code></pre>"},{"location":"development/release-process/#references","title":"References","text":"<ul> <li>Semantic Versioning</li> <li>GitHub Releases API</li> </ul>"},{"location":"development/testing/","title":"Testing","text":"<p>This document describes the testing strategy and guidelines for K0rdentd.</p>"},{"location":"development/testing/#testing-framework","title":"Testing Framework","text":"<p>We use:</p> <ul> <li>Ginkgo: BDD testing framework</li> <li>Gomega: Matcher library</li> <li>Fake Clientset: For mocking Kubernetes API</li> </ul>"},{"location":"development/testing/#running-tests","title":"Running Tests","text":""},{"location":"development/testing/#all-tests","title":"All Tests","text":"<pre><code>make test\n</code></pre>"},{"location":"development/testing/#specific-package","title":"Specific Package","text":"<pre><code>go test ./pkg/config/... -v\n</code></pre>"},{"location":"development/testing/#specific-test","title":"Specific Test","text":"<pre><code>go test ./pkg/k0s -v -run TestCheckK0s\n</code></pre>"},{"location":"development/testing/#with-coverage","title":"With Coverage","text":"<pre><code>go test -coverprofile=coverage.out ./...\ngo tool cover -html=coverage.out\n</code></pre>"},{"location":"development/testing/#test-structure","title":"Test Structure","text":""},{"location":"development/testing/#unit-tests","title":"Unit Tests","text":"<p>Place tests alongside the code:</p> <pre><code>pkg/\n\u251c\u2500\u2500 k0s/\n\u2502   \u251c\u2500\u2500 checker.go\n\u2502   \u2514\u2500\u2500 checker_test.go\n\u251c\u2500\u2500 config/\n\u2502   \u251c\u2500\u2500 k0rdentd.go\n\u2502   \u2514\u2500\u2500 k0rdentd_test.go\n\u2514\u2500\u2500 credentials/\n    \u251c\u2500\u2500 credentials.go\n    \u2514\u2500\u2500 credentials_test.go\n</code></pre>"},{"location":"development/testing/#test-file-naming","title":"Test File Naming","text":"<ul> <li>Unit tests: <code>&lt;name&gt;_test.go</code></li> <li>Integration tests: <code>&lt;name&gt;_integration_test.go</code></li> </ul>"},{"location":"development/testing/#writing-tests","title":"Writing Tests","text":""},{"location":"development/testing/#basic-test-structure","title":"Basic Test Structure","text":"<pre><code>package k0s_test\n\nimport (\n    . \"github.com/onsi/ginkgo/v2\"\n    . \"github.com/onsi/gomega\"\n\n    \"github.com/belgaied2/k0rdentd/pkg/k0s\"\n)\n\nvar _ = Describe(\"CheckK0s\", func() {\n    Context(\"when k0s is not installed\", func() {\n        It(\"should return Installed=false\", func() {\n            result, err := k0s.CheckK0s()\n            Expect(err).NotTo(HaveOccurred())\n            Expect(result.Installed).To(BeFalse())\n        })\n    })\n\n    Context(\"when k0s is installed\", func() {\n        BeforeEach(func() {\n            // Setup: install mock k0s\n        })\n\n        AfterEach(func() {\n            // Cleanup\n        })\n\n        It(\"should return Installed=true and version\", func() {\n            result, err := k0s.CheckK0s()\n            Expect(err).NotTo(HaveOccurred())\n            Expect(result.Installed).To(BeTrue())\n            Expect(result.Version).NotTo(BeEmpty())\n        })\n    })\n})\n</code></pre>"},{"location":"development/testing/#testing-kubernetes-client","title":"Testing Kubernetes Client","text":"<p>Use fake clientset:</p> <pre><code>import (\n    \"k8s.io/client-go/kubernetes/fake\"\n    corev1 \"k8s.io/api/core/v1\"\n    metav1 \"k8s.io/apimachinery/pkg/apis/meta/v1\"\n)\n\nvar _ = Describe(\"NamespaceExists\", func() {\n    var (\n        client *k8sclient.Client\n        fakeClient *fake.Clientset\n    )\n\n    BeforeEach(func() {\n        fakeClient = fake.NewSimpleClientset()\n        client = &amp;k8sclient.Client{\n            Clientset: fakeClient,\n        }\n    })\n\n    Context(\"when namespace exists\", func() {\n        BeforeEach(func() {\n            ns := &amp;corev1.Namespace{\n                ObjectMeta: metav1.ObjectMeta{Name: \"test\"},\n            }\n            fakeClient.CoreV1().Namespaces().Create(context.Background(), ns, metav1.CreateOptions{})\n        })\n\n        It(\"should return true\", func() {\n            exists, err := client.NamespaceExists(\"test\")\n            Expect(err).NotTo(HaveOccurred())\n            Expect(exists).To(BeTrue())\n        })\n    })\n\n    Context(\"when namespace does not exist\", func() {\n        It(\"should return false\", func() {\n            exists, err := client.NamespaceExists(\"nonexistent\")\n            Expect(err).NotTo(HaveOccurred())\n            Expect(exists).To(BeFalse())\n        })\n    })\n})\n</code></pre>"},{"location":"development/testing/#testing-exec-commands","title":"Testing Exec Commands","text":"<p>Mock exec.Command:</p> <pre><code>// Use a helper function that can be mocked\ntype CommandExecutor interface {\n    Execute(name string, args ...string) ([]byte, error)\n}\n\ntype RealExecutor struct{}\n\nfunc (e *RealExecutor) Execute(name string, args ...string) ([]byte, error) {\n    cmd := exec.Command(name, args...)\n    return cmd.Output()\n}\n\ntype MockExecutor struct {\n    Output []byte\n    Error  error\n}\n\nfunc (e *MockExecutor) Execute(name string, args ...string) ([]byte, error) {\n    return e.Output, e.Error\n}\n</code></pre>"},{"location":"development/testing/#test-categories","title":"Test Categories","text":""},{"location":"development/testing/#unit-tests_1","title":"Unit Tests","text":"<p>Test individual functions and methods:</p> <ul> <li>Configuration parsing</li> <li>K0s config generation</li> <li>Credential creation logic</li> <li>Helper functions</li> </ul>"},{"location":"development/testing/#integration-tests","title":"Integration Tests","text":"<p>Test component interactions:</p> <ul> <li>K0s installation</li> <li>K0rdent deployment</li> <li>Credential creation</li> <li>UI exposure</li> </ul>"},{"location":"development/testing/#end-to-end-tests","title":"End-to-End Tests","text":"<p>Test complete workflows:</p> <ul> <li>Full installation</li> <li>Full uninstallation</li> <li>Airgap installation</li> </ul>"},{"location":"development/testing/#test-coverage","title":"Test Coverage","text":""},{"location":"development/testing/#requirements","title":"Requirements","text":"<ul> <li>Maintain &gt;80% code coverage</li> <li>Cover all business logic</li> <li>Cover error paths</li> </ul>"},{"location":"development/testing/#checking-coverage","title":"Checking Coverage","text":"<pre><code># Generate coverage report\ngo test -coverprofile=coverage.out ./...\n\n# View in browser\ngo tool cover -html=coverage.out\n\n# View summary\ngo tool cover -func=coverage.out\n</code></pre>"},{"location":"development/testing/#mocking","title":"Mocking","text":""},{"location":"development/testing/#kubernetes-api","title":"Kubernetes API","text":"<pre><code>import (\n    \"k8s.io/client-go/kubernetes/fake\"\n)\n\nfakeClient := fake.NewSimpleClientset()\n</code></pre>"},{"location":"development/testing/#file-system","title":"File System","text":"<pre><code>import (\n    \"testing/fstest\"\n)\n\nmemFS := &amp;fstest.MapFS{\n    \"test.yaml\": &amp;fstest.MapFile{\n        Data: []byte(\"content\"),\n    },\n}\n</code></pre>"},{"location":"development/testing/#environment-variables","title":"Environment Variables","text":"<pre><code>BeforeEach(func() {\n    os.Setenv(\"TEST_VAR\", \"value\")\n})\n\nAfterEach(func() {\n    os.Unsetenv(\"TEST_VAR\")\n})\n</code></pre>"},{"location":"development/testing/#best-practices","title":"Best Practices","text":""},{"location":"development/testing/#1-isolate-tests","title":"1. Isolate Tests","text":"<p>Each test should be independent:</p> <pre><code>BeforeEach(func() {\n    // Setup\n})\n\nAfterEach(func() {\n    // Cleanup\n})\n</code></pre>"},{"location":"development/testing/#2-use-descriptive-names","title":"2. Use Descriptive Names","text":"<pre><code>It(\"should return error when config file does not exist\", func() {\n    // ...\n})\n</code></pre>"},{"location":"development/testing/#3-test-edge-cases","title":"3. Test Edge Cases","text":"<pre><code>Context(\"when input is empty\", func() {\n    It(\"should return error\", func() {\n        // ...\n    })\n})\n\nContext(\"when input is invalid\", func() {\n    It(\"should return error\", func() {\n        // ...\n    })\n})\n</code></pre>"},{"location":"development/testing/#4-dont-test-external-dependencies","title":"4. Don't Test External Dependencies","text":"<p>Mock external calls:</p> <ul> <li>Network requests</li> <li>File system (when possible)</li> <li>External commands</li> </ul>"},{"location":"development/testing/#continuous-integration","title":"Continuous Integration","text":"<p>Tests run automatically on:</p> <ul> <li>Pull requests</li> <li>Pushes to main branch</li> </ul>"},{"location":"development/testing/#ci-configuration","title":"CI Configuration","text":"<p>Tests run in GitHub Actions:</p> <pre><code>- name: Run tests\n  run: make test\n</code></pre>"},{"location":"development/testing/#debugging-tests","title":"Debugging Tests","text":""},{"location":"development/testing/#verbose-output","title":"Verbose Output","text":"<pre><code>go test -v ./...\n</code></pre>"},{"location":"development/testing/#focus-specific-test","title":"Focus Specific Test","text":"<pre><code>It(\"should work\", func() {\n    // ...\n})\n</code></pre> <p>Run with:</p> <pre><code>go test -v -focus \"should work\"\n</code></pre>"},{"location":"development/testing/#debug-logging-in-tests","title":"Debug Logging in Tests","text":"<pre><code>import (\n    \"github.com/sirupsen/logrus\"\n)\n\nBeforeEach(func() {\n    logrus.SetLevel(logrus.DebugLevel)\n})\n</code></pre>"},{"location":"development/testing/#references","title":"References","text":"<ul> <li>Ginkgo Documentation</li> <li>Gomega Documentation</li> <li>Go Testing</li> </ul>"},{"location":"getting-started/configuration/","title":"Configuration","text":"<p>K0rdentd is configured via a YAML configuration file, by default located at <code>/etc/k0rdentd/k0rdentd.yaml</code>.</p>"},{"location":"getting-started/configuration/#configuration-file-location","title":"Configuration File Location","text":"<p>The configuration file location can be specified in several ways:</p> <ol> <li>Default: <code>/etc/k0rdentd/k0rdentd.yaml</code></li> <li>CLI Flag: <code>--config-file /path/to/config.yaml</code></li> <li>Environment Variable: <code>K0RDENTD_CONFIG_FILE=/path/to/config.yaml</code></li> </ol>"},{"location":"getting-started/configuration/#complete-configuration-reference","title":"Complete Configuration Reference","text":"<p>Here's a complete example configuration file with all available options:</p> <pre><code># K0s Configuration\nk0s:\n  version: \"v1.32.4+k0s.0\"\n  api:\n    address: \"0.0.0.0\"\n    port: 6443\n  network:\n    provider: \"calico\"\n    podCIDR: \"10.244.0.0/16\"\n    serviceCIDR: \"10.96.0.0/12\"\n  storage:\n    type: \"etcd\"\n    etcd:\n      peerAddress: \"127.0.0.1\"\n\n# K0rdent Configuration\nk0rdent:\n  version: \"v0.1.0\"\n  helm:\n    chart: \"k0rdent/k0rdent\"\n    namespace: \"kcm-system\"\n    values:\n      replicaCount: 1\n      service:\n        type: ClusterIP\n        port: 80\n\n# Cloud Provider Credentials (Optional)\nk0rdent:\n  credentials:\n    aws:\n      - name: aws-prod-credentials\n        region: us-east-1\n        accessKeyID: AKIA...\n        secretAccessKey: secret...\n        sessionToken: \"...\"  # Optional: for MFA or SSO\n    azure:\n      - name: azure-prod-credentials\n        subscriptionID: sub-id...\n        clientID: client-id...\n        clientSecret: secret...\n        tenantID: tenant-id...\n    openstack:\n      - name: openstack-prod-credentials\n        authURL: https://auth.example.com:5000/v3\n        region: RegionOne\n        applicationCredentialID: app-cred-id...\n        applicationCredentialSecret: app-cred-secret...\n\n# Airgap Configuration (Optional)\nairgap:\n  registry:\n    address: localhost:5000\n  bundlePath: /opt/k0rdent/airgap-bundle-1.2.3.tar.gz\n\n# Global Settings\ndebug: false\nlogLevel: \"info\"\n</code></pre>"},{"location":"getting-started/configuration/#configuration-sections","title":"Configuration Sections","text":""},{"location":"getting-started/configuration/#k0s-configuration","title":"K0s Configuration","text":"<p>The <code>k0s</code> section configures the underlying K0s cluster:</p> <pre><code>k0s:\n  # K0s version to install\n  version: \"v1.32.4+k0s.0\"\n\n  # API server configuration\n  api:\n    address: \"0.0.0.0\"  # API server bind address\n    port: 6443          # API server port\n\n  # Network configuration\n  network:\n    provider: \"calico\"           # CNI provider: calico, kuberouter\n    podCIDR: \"10.244.0.0/16\"     # Pod CIDR range\n    serviceCIDR: \"10.96.0.0/12\"  # Service CIDR range\n\n  # Storage configuration\n  storage:\n    type: \"etcd\"  # Storage type: etcd, kine\n    etcd:\n      peerAddress: \"127.0.0.1\"  # etcd peer address\n</code></pre>"},{"location":"getting-started/configuration/#k0rdent-configuration","title":"K0rdent Configuration","text":"<p>The <code>k0rdent</code> section configures the K0rdent deployment:</p> <pre><code>k0rdent:\n  # K0rdent version\n  version: \"v0.1.0\"\n\n  # Helm chart configuration\n  helm:\n    chart: \"k0rdent/k0rdent\"  # Helm chart reference\n    namespace: \"kcm-system\"   # Installation namespace\n\n    # Custom Helm values\n    values:\n      replicaCount: 1\n      service:\n        type: ClusterIP\n        port: 80\n</code></pre>"},{"location":"getting-started/configuration/#cloud-credentials-configuration","title":"Cloud Credentials Configuration","text":"<p>The <code>k0rdent.credentials</code> section configures cloud provider credentials:</p>"},{"location":"getting-started/configuration/#aws-credentials","title":"AWS Credentials","text":"<pre><code>k0rdent:\n  credentials:\n    aws:\n      - name: aws-prod-credentials\n        region: us-east-1\n        accessKeyID: AKIA...\n        secretAccessKey: secret...\n        sessionToken: \"...\"  # Optional: for MFA or SSO\n</code></pre>"},{"location":"getting-started/configuration/#azure-credentials","title":"Azure Credentials","text":"<pre><code>k0rdent:\n  credentials:\n    azure:\n      - name: azure-prod-credentials\n        subscriptionID: subscription-uuid\n        clientID: client-uuid\n        clientSecret: secret...\n        tenantID: tenant-uuid\n</code></pre>"},{"location":"getting-started/configuration/#openstack-credentials","title":"OpenStack Credentials","text":"<pre><code>k0rdent:\n  credentials:\n    openstack:\n      - name: openstack-prod-credentials\n        authURL: https://auth.example.com:5000/v3\n        region: RegionOne\n        # Option 1: Application Credentials\n        applicationCredentialID: app-cred-id...\n        applicationCredentialSecret: app-cred-secret...\n        # Option 2: Username/Password (alternative)\n        # username: admin\n        # password: secret\n        # projectName: myproject\n        # domainName: default\n</code></pre>"},{"location":"getting-started/configuration/#airgap-configuration","title":"Airgap Configuration","text":"<p>The <code>airgap</code> section configures airgap (offline) installation:</p> <pre><code>airgap:\n  registry:\n    address: localhost:5000  # Local registry address\n    # For multi-worker: use reachable IP\n    # address: 192.168.1.10:5000\n\n  # Path to k0rdent airgap bundle\n  bundlePath: /opt/k0rdent/airgap-bundle-1.2.3.tar.gz\n</code></pre>"},{"location":"getting-started/configuration/#global-settings","title":"Global Settings","text":"<pre><code># Enable debug logging\ndebug: false\n\n# Log level: debug, info, warn, error\nlogLevel: \"info\"\n</code></pre>"},{"location":"getting-started/configuration/#environment-variables","title":"Environment Variables","text":"<p>All configuration options can be overridden with environment variables:</p> Environment Variable Configuration Path <code>K0RDENTD_CONFIG_FILE</code> Configuration file path <code>K0RDENTD_DEBUG</code> <code>debug</code> <code>K0RDENTD_LOG_LEVEL</code> <code>logLevel</code> <code>K0RDENTD_K0S_VERSION</code> <code>k0s.version</code> <code>K0RDENTD_K0RDENT_VERSION</code> <code>k0rdent.version</code> <code>K0RDENTD_AIRGAP_BUNDLE_PATH</code> <code>airgap.bundlePath</code> <code>K0RDENTD_REGISTRY_ADDRESS</code> <code>airgap.registry.address</code> <p>Example:</p> <pre><code>export K0RDENTD_DEBUG=true\nexport K0RDENTD_K0S_VERSION=v1.32.4+k0s.0\nsudo k0rdentd install\n</code></pre>"},{"location":"getting-started/configuration/#generated-k0s-configuration","title":"Generated K0s Configuration","text":"<p>K0rdentd generates the K0s configuration file at <code>/etc/k0s/k0s.yaml</code> based on your <code>k0rdentd.yaml</code> settings. The generated configuration includes:</p> <ul> <li>API server settings</li> <li>Network configuration</li> <li>Storage configuration</li> <li>Helm extensions for K0rdent</li> </ul> <p>Example generated <code>k0s.yaml</code>:</p> <pre><code>apiVersion: k0s.k0sproject.io/v1beta1\nkind: Cluster\nmetadata:\n  name: k0s\nspec:\n  api:\n    address: \"0.0.0.0\"\n    port: 6443\n  network:\n    provider: \"calico\"\n    podCIDR: \"10.244.0.0/16\"\n    serviceCIDR: \"10.96.0.0/12\"\n  storage:\n    type: \"etcd\"\n    etcd:\n      peerAddress: \"127.0.0.1\"\n  extensions:\n    helm:\n      repositories:\n        - name: k0rdent\n          url: https://charts.k0rdent.io\n      charts:\n        - name: k0rdent\n          chartname: k0rdent/k0rdent\n          version: \"v0.1.0\"\n          namespace: kcm-system\n          values: |\n            replicaCount: 1\n            service:\n              type: ClusterIP\n              port: 80\n</code></pre>"},{"location":"getting-started/configuration/#validation","title":"Validation","text":"<p>K0rdentd validates the configuration before starting:</p> <ul> <li>Required fields are present</li> <li>Version formats are correct</li> <li>Network CIDRs are valid</li> <li>File paths exist (for airgap bundle)</li> </ul> <p>If validation fails, K0rdentd will log an error and exit.</p>"},{"location":"getting-started/configuration/#example-configurations","title":"Example Configurations","text":""},{"location":"getting-started/configuration/#minimal-configuration","title":"Minimal Configuration","text":"<pre><code>k0s:\n  version: \"v1.32.4+k0s.0\"\n\nk0rdent:\n  version: \"v0.1.0\"\n</code></pre>"},{"location":"getting-started/configuration/#production-configuration","title":"Production Configuration","text":"<pre><code>k0s:\n  version: \"v1.32.4+k0s.0\"\n  api:\n    address: \"0.0.0.0\"\n    port: 6443\n  network:\n    provider: \"calico\"\n    podCIDR: \"10.244.0.0/16\"\n    serviceCIDR: \"10.96.0.0/12\"\n  storage:\n    type: \"etcd\"\n    etcd:\n      peerAddress: \"127.0.0.1\"\n\nk0rdent:\n  version: \"v0.1.0\"\n  helm:\n    namespace: \"kcm-system\"\n  credentials:\n    aws:\n      - name: aws-prod\n        region: us-east-1\n        accessKeyID: ${AWS_ACCESS_KEY_ID}\n        secretAccessKey: ${AWS_SECRET_ACCESS_KEY}\n\ndebug: false\nlogLevel: \"info\"\n</code></pre>"},{"location":"getting-started/configuration/#airgap-configuration_1","title":"Airgap Configuration","text":"<pre><code>k0s:\n  version: \"v1.32.4+k0s.0\"\n\nk0rdent:\n  version: \"v0.1.0\"\n\nairgap:\n  registry:\n    address: localhost:5000\n  bundlePath: /opt/k0rdent/airgap-bundle-1.2.3.tar.gz\n\ndebug: false\nlogLevel: \"info\"\n</code></pre>"},{"location":"getting-started/installation/","title":"Installation","text":"<p>This guide covers how to install K0rdentd on your system.</p>"},{"location":"getting-started/installation/#prerequisites","title":"Prerequisites","text":"<p>Before installing K0rdentd, ensure your system meets the following requirements:</p>"},{"location":"getting-started/installation/#system-requirements","title":"System Requirements","text":"<ul> <li>Operating System: Linux (AMD64 or ARM64)</li> <li>Disk Space: </li> <li>Online mode: ~10 GB free</li> <li>Airgap mode: ~100 GB free (for bundle and registry)</li> <li>Memory: Minimum 4 GB RAM (8 GB recommended)</li> <li>Privileges: <code>sudo</code> access required</li> </ul>"},{"location":"getting-started/installation/#software-dependencies","title":"Software Dependencies","text":"<ul> <li><code>curl</code> or <code>wget</code> (for downloading)</li> <li><code>tar</code> (for extracting archives)</li> <li>For airgap installations:</li> <li><code>skopeo</code> (included in airgap binary)</li> <li><code>cosign</code> (optional, for bundle verification)</li> </ul>"},{"location":"getting-started/installation/#installation-methods","title":"Installation Methods","text":""},{"location":"getting-started/installation/#download-from-github-releases","title":"Download from GitHub Releases","text":"<p>The recommended way to install K0rdentd is to download the latest release from GitHub.</p>"},{"location":"getting-started/installation/#online-flavor-default-one-liner-installation","title":"Online Flavor (Default) - one-liner installation","text":"<pre><code># The following commands installs the latest version of K0rdentd\ncurl -sfL https://k0rdentd.belgai.de | sudo bash\n</code></pre>"},{"location":"getting-started/installation/#airgap-flavor","title":"Airgap Flavor","text":"<p>For offline installations, download the airgap build:</p> <pre><code># Set the version\nK0RDENTD_VERSION=\"v0.2.0\"\n\n# Download for AMD64\ncurl -L \"https://github.com/belgaied2/k0rdentd/releases/download/${K0RDENTD_VERSION}/k0rdentd-airgap-${K0RDENTD_VERSION}-linux-amd64.tar.gz\" -o k0rdentd-airgap.tar.gz\n\n# Extract\ntar -xzf k0rdentd-airgap.tar.gz\n\n# Install\nsudo mv k0rdentd-airgap /usr/local/bin/k0rdentd\nsudo chmod +x /usr/local/bin/k0rdentd\n</code></pre> <p>NOTE: Please be aware that the airgap version needs the official K0rdent Enterprise bundle for the actual installation of K0s and K0rdent.</p>"},{"location":"getting-started/installation/#build-from-source","title":"Build from Source","text":"<p>If you prefer to build from source:</p> <pre><code># Clone the repository\ngit clone https://github.com/belgaied2/k0rdentd.git\ncd k0rdentd\n\n# Build online flavor\nmake build\n\n# Or build airgap flavor\nmake build-airgap\n\n# Install\nsudo cp bin/k0rdentd /usr/local/bin/\n</code></pre>"},{"location":"getting-started/installation/#verify-installation","title":"Verify Installation","text":"<p>After installation, verify that K0rdentd is working:</p> <pre><code># Check version\nk0rdentd version\n\n# Check build flavor\nk0rdentd show-flavor\n</code></pre> <p>Expected output:</p> <pre><code>k0rdentd version v0.2.0\nA CLI tool to deploy K0s and K0rdent\nCopyright \u00a9 2024 belgaied2\n</code></pre>"},{"location":"getting-started/installation/#next-steps","title":"Next Steps","text":"<ul> <li>Quick Start Guide - Get K0rdent running quickly</li> <li>Configuration - Learn about configuration options</li> <li>Airgap Installation - For offline environments</li> </ul>"},{"location":"getting-started/installation/#troubleshooting","title":"Troubleshooting","text":""},{"location":"getting-started/installation/#permission-denied","title":"Permission Denied","text":"<p>If you get permission errors:</p> <pre><code># Ensure binary is executable\nsudo chmod +x /usr/local/bin/k0rdentd\n\n# Ensure config directory has correct permissions\nsudo chown -R root:root /etc/k0rdentd\nsudo chmod 755 /etc/k0rdentd\n</code></pre>"},{"location":"getting-started/installation/#binary-not-found","title":"Binary Not Found","text":"<p>If the <code>k0rdentd</code> command is not found:</p> <pre><code># Check if it's in your PATH\nwhich k0rdentd\n\n# If not, add the directory to PATH\nexport PATH=$PATH:/usr/local/bin\n\n# Or move to a directory in PATH\nsudo mv k0rdentd /usr/local/bin/\n</code></pre>"},{"location":"getting-started/installation/#k0s-installation-issues","title":"K0s Installation Issues","text":"<p>K0rdentd will automatically install K0s if it's not present. If you encounter issues:</p> <pre><code># Check if k0s is installed\nwhich k0s\n\n# Install k0s manually\ncurl -sSLf https://get.k0s.sh | sudo sh\n</code></pre>"},{"location":"getting-started/quick-start/","title":"Quick Start","text":"<p>Get K0rdent up and running in minutes with this quick start guide.</p>"},{"location":"getting-started/quick-start/#prerequisites","title":"Prerequisites","text":"<ul> <li>Linux VM with sudo access</li> <li>Internet access (for online installation)</li> <li>At least 4 GB RAM and 10 GB disk space</li> </ul>"},{"location":"getting-started/quick-start/#step-1-install-k0rdentd","title":"Step 1: Install K0rdentd","text":"<pre><code>curl -sfL https://k0rdentd.belgai.de | sudo bash\n</code></pre>"},{"location":"getting-started/quick-start/#step-2-run-installation","title":"Step 2: Run Installation","text":"<pre><code># Install K0s and K0rdent\nsudo k0rdentd install\n</code></pre> <p>The installation process will:</p> <ol> <li>Check for and install K0s if needed</li> <li>Generate K0s configuration</li> <li>Start the K0s cluster</li> <li>Deploy K0rdent using Helm</li> <li>Wait for all components to be ready</li> <li>Display access information</li> </ol>"},{"location":"getting-started/quick-start/#step-3-check-out-k0rdent-enterprise-ui","title":"Step 3: Check out K0rdent Enterprise UI","text":"<p>The previous step would have shown options to access the K0rdent UI. If one of these options is available from your workstation, </p> <p>Expected output:</p> <pre><code>NAME                                              READY   STATUS    RESTARTS   AGE\nk0rdent-cert-manager-xxx                          1/1     Running   0          5m\nk0rdent-cert-manager-cainjector-xxx               1/1     Running   0          5m\nk0rdent-cert-manager-webhook-xxx                  1/1     Running   0          5m\nk0rdent-datasource-controller-manager-xxx         1/1     Running   0          5m\nk0rdent-k0rdent-enterprise-controller-manager-xxx 1/1     Running   0          5m\nk0rdent-k0rdent-ui-xxx                            1/1     Running   0          5m\nk0rdent-rbac-manager-xxx                          1/1     Running   0          5m\nk0rdent-regional-telemetry-xxx                    1/1     Running   0          5m\n</code></pre>"},{"location":"getting-started/quick-start/#step-5-access-k0rdent-ui","title":"Step 5: Access K0rdent UI","text":"<p>After installation, K0rdentd will display URLs to access the K0rdent UI. You can also expose it manually:</p> <pre><code># Expose the UI\nsudo k0rdentd expose-ui\n</code></pre> <p>This will:</p> <ol> <li>Create an ingress for the UI</li> <li>Detect available IP addresses</li> <li>Display access URLs</li> </ol>"},{"location":"getting-started/quick-start/#next-steps","title":"Next Steps","text":"<p>Now that you have K0rdent running, you can:</p> <ul> <li>Configure Cloud Credentials: Add AWS, Azure, or OpenStack credentials</li> <li>Create Clusters: Use K0rdent to manage Kubernetes clusters</li> <li>Explore the UI: Access the web interface for cluster management</li> </ul>"},{"location":"getting-started/quick-start/#configure-cloud-credentials","title":"Configure Cloud Credentials","text":"<p>Add credentials to your configuration:</p> <pre><code>k0rdent:\n  credentials:\n    aws:\n      - name: aws-prod\n        region: us-east-1\n        accessKeyID: AKIA...\n        secretAccessKey: secret...\n</code></pre> <p>Then run:</p> <pre><code>sudo k0rdentd install\n</code></pre>"},{"location":"getting-started/quick-start/#create-your-first-cluster","title":"Create Your First Cluster","text":"<p>Use K0rdent to create a cluster:</p> <pre><code># Get kubeconfig\nsudo k0s kubeconfig admin &gt; ~/.kube/config\n\n# Create a cluster using k0rdent CLI or UI\n</code></pre>"},{"location":"getting-started/quick-start/#common-issues","title":"Common Issues","text":""},{"location":"getting-started/quick-start/#installation-stuck","title":"Installation Stuck","text":"<p>If installation seems stuck:</p> <pre><code># Check logs\nsudo journalctl -u k0scontroller -f\n\n# Check pod status\nsudo k0s kubectl get pods -A\n</code></pre>"},{"location":"getting-started/quick-start/#pod-image-pull-errors","title":"Pod Image Pull Errors","text":"<p>If pods fail to pull images:</p> <pre><code># Check if images are being pulled\nsudo k0s kubectl describe pod &lt;pod-name&gt; -n kcm-system\n\n# Check network connectivity\ncurl -I https://registry.k8s.io\n</code></pre>"},{"location":"getting-started/quick-start/#ui-not-accessible","title":"UI Not Accessible","text":"<p>If you can't access the UI:</p> <pre><code># Check ingress\nsudo k0s kubectl get ingress -A\n\n# Check service\nsudo k0s kubectl get svc -n kcm-system\n\n# Try port-forwarding\nsudo k0s kubectl port-forward -n kcm-system svc/k0rdent-k0rdent-ui 8080:80\n</code></pre>"},{"location":"getting-started/quick-start/#clean-up","title":"Clean Up","text":"<p>To uninstall K0rdent and K0s:</p> <pre><code># Uninstall everything\nsudo k0rdentd uninstall\n</code></pre> <p>This will remove K0rdent and K0s from your system.</p>"},{"location":"user-guide/airgap-installation/","title":"Airgap Installation","text":"<p>This guide covers installing K0rdent in airgap (offline) environments using K0rdentd.</p>"},{"location":"user-guide/airgap-installation/#overview","title":"Overview","text":"<p>Airgap installation allows you to deploy K0s and K0rdent in environments without internet access. The process involves:</p> <ol> <li>Online Machine: Download artifacts</li> <li>Airgap Machine: Transfer and install</li> </ol>"},{"location":"user-guide/airgap-installation/#architecture","title":"Architecture","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                              VM-online (Internet)                            \u2502\n\u2502                                                                              \u2502\n\u2502  1. Download k0rdentd-airgap binary from GitHub                             \u2502\n\u2502  2. Download K0rdent Enterprise Airgap Bundle from Mirantis                 \u2502\n\u2502  3. Transfer artifacts to airgap VMs via SSH                                \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                                     \u2502\n                                     \u2502 SSH/SCP\n                                     \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                     k0rdent-airgap-* (No Internet)                          \u2502\n\u2502                                                                              \u2502\n\u2502  1. Receive artifacts from VM-online                                        \u2502\n\u2502  2. Start local OCI registry daemon                                         \u2502\n\u2502  3. Run k0rdentd install (airgap mode)                                      \u2502\n\u2502  4. K0s cluster with K0rdent ready                                         \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"user-guide/airgap-installation/#prerequisites","title":"Prerequisites","text":""},{"location":"user-guide/airgap-installation/#on-online-machine","title":"On Online Machine","text":"<ul> <li>Internet access</li> <li>SSH client</li> <li><code>curl</code> or <code>wget</code></li> <li><code>cosign</code> (optional, for bundle verification)</li> </ul>"},{"location":"user-guide/airgap-installation/#on-airgap-machine","title":"On Airgap Machine","text":"<ul> <li>No internet access required</li> <li>SSH server running</li> <li>Linux AMD64 or ARM64</li> <li>Recommended disk: 100 GB</li> <li>~50 GB for bundle extraction and registry storage</li> <li>~10 GB additional for K0s and K0rdent</li> <li><code>sudo</code> privileges</li> </ul>"},{"location":"user-guide/airgap-installation/#phase-1-prepare-on-online-machine","title":"Phase 1: Prepare on Online Machine","text":""},{"location":"user-guide/airgap-installation/#step-11-download-k0rdentd-airgap-binary","title":"Step 1.1: Download K0rdentd Airgap Binary","text":"<pre><code># Set the version\nK0RDENTD_VERSION=\"v0.2.0\"\n\n# Download for AMD64\ncurl -L \"https://github.com/belgaied2/k0rdentd/releases/download/${K0RDENTD_VERSION}/k0rdentd-airgap-${K0RDENTD_VERSION}-linux-amd64.tar.gz\" -o k0rdentd-airgap.tar.gz\n\n# Or for ARM64\ncurl -L \"https://github.com/belgaied2/k0rdentd/releases/download/${K0RDENTD_VERSION}/k0rdentd-airgap-${K0RDENTD_VERSION}-linux-arm64.tar.gz\" -o k0rdentd-airgap.tar.gz\n</code></pre>"},{"location":"user-guide/airgap-installation/#step-12-download-k0rdent-enterprise-airgap-bundle","title":"Step 1.2: Download K0rdent Enterprise Airgap Bundle","text":"<pre><code># Set the K0rdent version\nK0RDENT_VERSION=\"1.2.2\"\n\n# Download the bundle (~22 GB)\ncurl -L \"https://get.mirantis.com/k0rdent-enterprise/${K0RDENT_VERSION}/airgap-bundle-${K0RDENT_VERSION}.tar.gz\" -o airgap-bundle-${K0RDENT_VERSION}.tar.gz\n</code></pre>"},{"location":"user-guide/airgap-installation/#step-13-transfer-artifacts","title":"Step 1.3: Transfer Artifacts","text":"<pre><code># Set target VM details\nTARGET_USER=\"ubuntu\"\nTARGET_VM=\"k0rdent-airgap-01\"  # Replace with actual hostname/IP\n\n# Transfer all artifacts\nscp k0rdentd-airgap.tar.gz ${TARGET_USER}@${TARGET_VM}:/tmp/\nscp airgap-bundle-${K0RDENT_VERSION}.tar.gz ${TARGET_USER}@${TARGET_VM}:/tmp/\n</code></pre>"},{"location":"user-guide/airgap-installation/#phase-2-install-on-bootstrap-node","title":"Phase 2: Install on Bootstrap Node","text":"<p>SSH into the bootstrap node:</p> <pre><code>ssh ${TARGET_USER}@k0rdent-airgap-01\n</code></pre>"},{"location":"user-guide/airgap-installation/#step-21-install-k0rdentd-binary","title":"Step 2.1: Install K0rdentd Binary","text":"<pre><code># Extract and install\ntar -xzf /tmp/k0rdentd-airgap.tar.gz\nsudo mkdir -p /usr/local/bin\nsudo cp k0rdentd-airgap /usr/local/bin/k0rdentd\nsudo chmod +x /usr/local/bin/k0rdentd\n\n# Verify installation\nk0rdentd version\nk0rdentd show-flavor  # Should output \"airgap\"\n</code></pre>"},{"location":"user-guide/airgap-installation/#step-22-create-configuration","title":"Step 2.2: Create Configuration","text":"<pre><code>sudo mkdir -p /etc/k0rdentd\n\nsudo tee /etc/k0rdentd/k0rdentd.yaml &gt; /dev/null &lt;&lt;EOF\nk0s:\n  version: \"v1.32.4+k0s.0\"\n\nk0rdent:\n  version: \"1.2.2\"\n\nairgap:\n  registry:\n    address: localhost:5000\n  bundlePath: /opt/k0rdent/airgap-bundle-1.2.2.tar.gz\n\ndebug: false\nlogLevel: \"info\"\nEOF\n\n# Move bundle to configured location\nsudo mkdir -p /opt/k0rdent\nsudo mv /tmp/airgap-bundle-1.2.2.tar.gz /opt/k0rdent/\n</code></pre>"},{"location":"user-guide/airgap-installation/#step-23-start-the-oci-registry-daemon","title":"Step 2.3: Start the OCI Registry Daemon","text":"<p>Important</p> <p>The registry daemon must be running before installation. Open a new terminal or run in background.</p> <pre><code># Terminal 1: Start registry daemon\nsudo k0rdentd registry \\\n  --bundle-path /opt/k0rdent/airgap-bundle-1.2.2.tar.gz \\\n  --port 5000 \\\n  --storage /var/lib/k0rdentd/registry\n</code></pre> <p>No Feedback</p> <p>As of v0.2.0, this step might seem like it's hanging because uncompressing the 22GB+ tar file takes time. You can verify tar is running with <code>top</code> or <code>ps -ef | grep tar</code>.</p> <p>Expected output:</p> <pre><code>INFO[0000] Starting k0rdentd registry daemon...\nINFO[0000] Configuration:\nINFO[0000]   Bundle: /opt/k0rdent/airgap-bundle-1.2.2.tar.gz\nINFO[0000]   Storage: /var/lib/k0rdentd/registry\nINFO[0000]   Address: 0.0.0.0:5000\nINFO[0000] Pushing images from bundle to local registry...\nINFO[0001] [1/233] Pushing kcm-controller:1.2.2...\n...\nINFO[1235] Registry server listening on 0.0.0.0:5000\n</code></pre>"},{"location":"user-guide/airgap-installation/#step-24-run-installation","title":"Step 2.4: Run Installation","text":"<p>In a new terminal (or after starting registry in background):</p> <pre><code># Terminal 2: Run installation\nsudo k0rdentd install\n</code></pre> <p>The installation will:</p> <ol> <li>Extract embedded K0s binary to <code>/usr/local/bin/k0s</code></li> <li>Configure containerd registry mirrors</li> <li>Generate K0s configuration for airgap mode</li> <li>Install and start K0s cluster</li> <li>Wait for K0rdent to be installed via K0s Helm extension</li> <li>Create cloud provider credentials (if configured)</li> </ol>"},{"location":"user-guide/airgap-installation/#step-25-verify-installation","title":"Step 2.5: Verify Installation","text":"<pre><code># Check K0s status\nsudo k0s status\n\n# Check K0rdent pods\nsudo k0s kubectl get pods -n kcm-system\n</code></pre> <p>Expected output: All pods in Running state.</p>"},{"location":"user-guide/airgap-installation/#step-26-access-k0rdent-ui","title":"Step 2.6: Access K0rdent UI","text":"<p>The CLI displays URLs to access the UI. For SSH port forwarding:</p> <pre><code># Get NodePort\nNODEPORT=$(sudo k0s kubectl get svc -n kcm-system k0rdent-k0rdent-ui -o jsonpath='{.spec.ports[0].nodePort}')\n\n# On your local machine\nssh -J vm-online -L 8080:localhost:$NODEPORT $TARGET_USER@$TARGET_VM\n</code></pre> <p>Then access: <code>http://localhost:8080/k0rdent-ui</code></p>"},{"location":"user-guide/airgap-installation/#phase-3-add-worker-nodes-optional","title":"Phase 3: Add Worker Nodes (Optional)","text":""},{"location":"user-guide/airgap-installation/#step-31-generate-join-token-on-bootstrap","title":"Step 3.1: Generate Join Token on Bootstrap","text":"<pre><code># On bootstrap node\nsudo k0s token create --role=worker &gt; /tmp/worker-token\n</code></pre>"},{"location":"user-guide/airgap-installation/#step-32-export-worker-artifacts","title":"Step 3.2: Export Worker Artifacts","text":"<pre><code># On bootstrap node\nk0rdentd export-worker-artifacts \\\n  --output /tmp/worker-bundle \\\n  --bundle-path /opt/k0rdent/airgap-bundle-1.2.2.tar.gz\n\n# Transfer to workers\nscp -r /tmp/worker-bundle ${TARGET_USER}@k0rdent-airgap-02:/tmp/\n</code></pre>"},{"location":"user-guide/airgap-installation/#step-33-join-worker-nodes","title":"Step 3.3: Join Worker Nodes","text":"<p>On each worker node:</p> <pre><code># Install K0s binary\nsudo cp /tmp/worker-bundle/k0s /usr/local/bin/k0s\nsudo chmod +x /usr/local/bin/k0s\n\n# Configure containerd to use bootstrap node's registry\nBOOTSTRAP_IP=\"192.168.1.10\"  # Replace with actual IP\n\nsudo mkdir -p /etc/k0s/containerd.d/certs.d/registry.k8s.io\nsudo mkdir -p /etc/k0s/containerd.d/certs.d/quay.io\n\ncat &lt;&lt;EOF | sudo tee /etc/k0s/containerd.d/certs.d/registry.k8s.io/hosts.toml\nserver = \"https://registry.k8s.io\"\n[host.\"http://${BOOTSTRAP_IP}:5000\"]\n  capabilities = [\"pull\", \"resolve\"]\nEOF\n\ncat &lt;&lt;EOF | sudo tee /etc/k0s/containerd.d/certs.d/quay.io/hosts.toml\nserver = \"https://quay.io\"\n[host.\"http://${BOOTSTRAP_IP}:5000\"]\n  capabilities = [\"pull\", \"resolve\"]\nEOF\n\n# Join the cluster\nsudo k0s worker $(cat /tmp/worker-token)\n</code></pre>"},{"location":"user-guide/airgap-installation/#cli-commands-reference","title":"CLI Commands Reference","text":""},{"location":"user-guide/airgap-installation/#registry-daemon","title":"Registry Daemon","text":"<pre><code># Start registry (foreground)\nsudo k0rdentd registry \\\n  --bundle-path /opt/k0rdent/airgap-bundle-1.2.2.tar.gz \\\n  --port 5000 \\\n  --storage /var/lib/k0rdentd/registry\n\n# With signature verification\nsudo k0rdentd registry \\\n  --bundle-path /opt/k0rdent/airgap-bundle-1.2.2.tar.gz \\\n  --verify true \\\n  --cosignKey https://get.mirantis.com/cosign.pub\n\n# For multi-worker: bind to all interfaces\nsudo k0rdentd registry \\\n  --bundle-path /opt/k0rdent/airgap-bundle-1.2.2.tar.gz \\\n  --host 0.0.0.0 \\\n  --port 5000\n</code></pre>"},{"location":"user-guide/airgap-installation/#installation","title":"Installation","text":"<pre><code># Install with config file\nsudo k0rdentd install --config-file /etc/k0rdentd/k0rdentd.yaml\n\n# Debug mode\nsudo k0rdentd install --debug\n\n# Dry-run\nsudo k0rdentd install --dry-run\n</code></pre>"},{"location":"user-guide/airgap-installation/#file-locations","title":"File Locations","text":"File Location Purpose K0rdentd binary <code>/usr/local/bin/k0rdentd</code> Main CLI tool K0s binary <code>/usr/local/bin/k0s</code> Kubernetes distribution K0rdentd config <code>/etc/k0rdentd/k0rdentd.yaml</code> Main configuration K0s config <code>/etc/k0s/k0s.yaml</code> K0s cluster configuration Bundle location <code>/opt/k0rdent/airgap-bundle-*.tar.gz</code> K0rdent airgap bundle Registry storage <code>/var/lib/k0rdentd/registry</code> OCI registry data Containerd config <code>/etc/k0s/containerd.d/</code> Containerd drop-in configs"},{"location":"user-guide/airgap-installation/#troubleshooting","title":"Troubleshooting","text":""},{"location":"user-guide/airgap-installation/#registry-issues","title":"Registry Issues","text":"<p>Port already in use:</p> <pre><code># Check what's using port 5000\nsudo lsof -i :5000\n\n# Use a different port\nsudo k0rdentd registry --port 5001 ...\n</code></pre> <p>Images fail to push:</p> <pre><code># Check disk space\ndf -h /var/lib/k0rdentd/registry\n\n# Check bundle integrity\ntar -tzf /opt/k0rdent/airgap-bundle-*.tar.gz | head\n</code></pre>"},{"location":"user-guide/airgap-installation/#installation-issues","title":"Installation Issues","text":"<p>Pods stuck in ImagePullBackOff:</p> <pre><code># Verify containerd mirror configuration\ncat /etc/k0s/containerd.d/cri-registry.toml\ncat /etc/k0s/containerd.d/certs.d/quay.io/hosts.toml\n\n# Verify registry is accessible\ncurl http://localhost:5000/v2/_catalog\n\n# Check K0s logs\nsudo journalctl -u k0scontroller -f\n</code></pre> <p>K0rdent pods not starting:</p> <pre><code># Check K0rdent Helm release status\nsudo k0s kubectl get helmchart -n kube-system\n\n# Check K0rdent logs\nsudo k0s kubectl logs -n kcm-system -l app.kubernetes.io/name=kcm\n</code></pre>"},{"location":"user-guide/airgap-installation/#verification-commands","title":"Verification Commands","text":"<pre><code># Check K0s cluster status\nsudo k0s status\nsudo k0s kubectl get nodes\n\n# Check K0rdent installation\nsudo k0s kubectl get pods -n kcm-system\nsudo k0s kubectl get clustermanagement -A\n\n# Check local registry\ncurl http://localhost:5000/v2/_catalog | jq\ncurl http://localhost:5000/v2/kcm-controller/tags/list | jq\n</code></pre>"},{"location":"user-guide/airgap-installation/#references","title":"References","text":"<ul> <li>K0rdentd GitHub Repository</li> <li>K0rdent Enterprise Documentation</li> <li>K0s Airgap Installation</li> <li>K0rdent Airgap Installation</li> <li>Containerd Registry Configuration</li> </ul>"},{"location":"user-guide/cli-reference/","title":"CLI Reference","text":"<p>Complete reference for all K0rdentd CLI commands.</p>"},{"location":"user-guide/cli-reference/#global-flags","title":"Global Flags","text":"<p>These flags apply to all commands:</p> Flag Environment Variable Default Description <code>--config-file, -c</code> <code>K0RDENTD_CONFIG_FILE</code> <code>/etc/k0rdentd/k0rdentd.yaml</code> Path to configuration file <code>--debug</code> <code>K0RDENTD_DEBUG</code> <code>false</code> Enable debug logging <code>--dry-run</code> - <code>false</code> Show what would be done without making changes <code>--help, -h</code> - - Show help for command"},{"location":"user-guide/cli-reference/#install","title":"install","text":"<p>Install K0s and K0rdent on the VM.</p>"},{"location":"user-guide/cli-reference/#usage","title":"Usage","text":"<pre><code>k0rdentd install [flags]\n</code></pre>"},{"location":"user-guide/cli-reference/#flags","title":"Flags","text":"Flag Default Description <code>--config-file, -c</code> <code>/etc/k0rdentd/k0rdentd.yaml</code> Path to configuration file <code>--airgap</code> <code>false</code> Force airgap mode installation <code>--debug</code> <code>false</code> Enable debug logging <code>--dry-run</code> <code>false</code> Show what would be done"},{"location":"user-guide/cli-reference/#examples","title":"Examples","text":"<pre><code># Basic installation\nsudo k0rdentd install\n\n# With custom config file\nsudo k0rdentd install -c /path/to/config.yaml\n\n# Airgap installation\nsudo k0rdentd install --airgap\n\n# Debug mode\nsudo k0rdentd install --debug\n\n# Dry run\nsudo k0rdentd install --dry-run\n</code></pre>"},{"location":"user-guide/cli-reference/#what-it-does","title":"What It Does","text":"<ol> <li>Checks if K0s binary exists, installs if missing</li> <li>Generates K0s configuration from k0rdentd.yaml</li> <li>Installs K0s controller with worker enabled</li> <li>Starts K0s service</li> <li>Waits for K0s to be ready</li> <li>Waits for K0rdent Helm chart to be installed</li> <li>Creates cloud provider credentials (if configured)</li> <li>Exposes K0rdent UI</li> </ol>"},{"location":"user-guide/cli-reference/#exit-codes","title":"Exit Codes","text":"Code Meaning 0 Success 1 General error 2 Configuration error 3 Installation error"},{"location":"user-guide/cli-reference/#uninstall","title":"uninstall","text":"<p>Uninstall K0s and K0rdent from the VM.</p>"},{"location":"user-guide/cli-reference/#usage_1","title":"Usage","text":"<pre><code>k0rdentd uninstall [flags]\n</code></pre>"},{"location":"user-guide/cli-reference/#flags_1","title":"Flags","text":"Flag Default Description <code>--config-file, -c</code> <code>/etc/k0rdentd/k0rdentd.yaml</code> Path to configuration file <code>--force</code> <code>false</code> Force uninstall without confirmation <code>--debug</code> <code>false</code> Enable debug logging"},{"location":"user-guide/cli-reference/#examples_1","title":"Examples","text":"<pre><code># Basic uninstall\nsudo k0rdentd uninstall\n\n# Force uninstall\nsudo k0rdentd uninstall --force\n\n# With custom config\nsudo k0rdentd uninstall -c /path/to/config.yaml\n</code></pre>"},{"location":"user-guide/cli-reference/#what-it-does_1","title":"What It Does","text":"<ol> <li>Stops K0s service</li> <li>Uninstalls K0s</li> <li>Removes configuration files</li> <li>Cleans up data directories (optional)</li> </ol>"},{"location":"user-guide/cli-reference/#version","title":"version","text":"<p>Show version information.</p>"},{"location":"user-guide/cli-reference/#usage_2","title":"Usage","text":"<pre><code>k0rdentd version [flags]\n</code></pre>"},{"location":"user-guide/cli-reference/#flags_2","title":"Flags","text":"Flag Default Description <code>--json</code> <code>false</code> Output in JSON format <code>--short</code> <code>false</code> Show only version number"},{"location":"user-guide/cli-reference/#examples_2","title":"Examples","text":"<pre><code># Show version\nk0rdentd version\n\n# Short format\nk0rdentd version --short\n\n# JSON format\nk0rdentd version --json\n</code></pre>"},{"location":"user-guide/cli-reference/#output","title":"Output","text":"<pre><code>k0rdentd version v0.2.0\nA CLI tool to deploy K0s and K0rdent\nCopyright \u00a9 2024 belgaied2\n</code></pre>"},{"location":"user-guide/cli-reference/#expose-ui","title":"expose-ui","text":"<p>Expose the K0rdent UI via ingress and display access URLs.</p>"},{"location":"user-guide/cli-reference/#usage_3","title":"Usage","text":"<pre><code>k0rdentd expose-ui [flags]\n</code></pre>"},{"location":"user-guide/cli-reference/#flags_3","title":"Flags","text":"Flag Default Description <code>--config-file, -c</code> <code>/etc/k0rdentd/k0rdentd.yaml</code> Path to configuration file <code>--timeout</code> <code>5m</code> Timeout for waiting for UI <code>--path</code> <code>/k0rdent-ui</code> Ingress path <code>--debug</code> <code>false</code> Enable debug logging"},{"location":"user-guide/cli-reference/#examples_3","title":"Examples","text":"<pre><code># Expose UI with defaults\nsudo k0rdentd expose-ui\n\n# Custom timeout\nsudo k0rdentd expose-ui --timeout 10m\n\n# Custom path\nsudo k0rdentd expose-ui --path /ui\n</code></pre>"},{"location":"user-guide/cli-reference/#what-it-does_2","title":"What It Does","text":"<ol> <li>Waits for K0rdent UI deployment to be ready</li> <li>Checks K0rdent UI service</li> <li>Creates ingress for UI</li> <li>Detects VM IP addresses</li> <li>Filters out Calico and Docker interfaces</li> <li>Tests UI accessibility</li> <li>Displays access URLs</li> </ol>"},{"location":"user-guide/cli-reference/#registry","title":"registry","text":"<p>Start the OCI registry daemon for airgap installations.</p>"},{"location":"user-guide/cli-reference/#usage_4","title":"Usage","text":"<pre><code>k0rdentd registry [flags]\n</code></pre>"},{"location":"user-guide/cli-reference/#flags_4","title":"Flags","text":"Flag Default Description <code>--bundle-path, -b</code> - Path to k0rdent airgap bundle (required) <code>--port, -p</code> <code>5000</code> Registry port <code>--host</code> <code>0.0.0.0</code> Host to bind to <code>--storage, -s</code> <code>/var/lib/k0rdentd/registry</code> Storage directory <code>--verify</code> <code>false</code> Verify bundle signature <code>--cosignKey</code> - Cosign public key URL or path <code>--daemon, -d</code> <code>false</code> Run as background daemon <code>--debug</code> <code>false</code> Enable debug logging"},{"location":"user-guide/cli-reference/#examples_4","title":"Examples","text":"<pre><code># Start registry with bundle\nsudo k0rdentd registry -b /path/to/bundle.tar.gz\n\n# Custom port\nsudo k0rdentd registry -b /path/to/bundle.tar.gz -p 5001\n\n# With signature verification\nsudo k0rdentd registry -b /path/to/bundle.tar.gz \\\n  --verify true \\\n  --cosignKey https://get.mirantis.com/cosign.pub\n\n# Run as daemon\nsudo k0rdentd registry -b /path/to/bundle.tar.gz -d\n</code></pre>"},{"location":"user-guide/cli-reference/#what-it-does_3","title":"What It Does","text":"<ol> <li>Verifies bundle signature (if enabled)</li> <li>Extracts k0rdent version from bundle</li> <li>Initializes local OCI registry</li> <li>Pushes images from bundle to registry</li> <li>Starts HTTP server</li> <li>Handles graceful shutdown</li> </ol>"},{"location":"user-guide/cli-reference/#export-worker-artifacts","title":"export-worker-artifacts","text":"<p>Export artifacts needed for worker nodes in airgap installations.</p>"},{"location":"user-guide/cli-reference/#usage_5","title":"Usage","text":"<pre><code>k0rdentd export-worker-artifacts [flags]\n</code></pre>"},{"location":"user-guide/cli-reference/#flags_5","title":"Flags","text":"Flag Default Description <code>--output, -o</code> <code>/tmp/worker-bundle</code> Output directory <code>--bundle-path, -b</code> - Path to k0rdent airgap bundle <code>--debug</code> <code>false</code> Enable debug logging"},{"location":"user-guide/cli-reference/#examples_5","title":"Examples","text":"<pre><code># Export to default location\nk0rdentd export-worker-artifacts\n\n# Custom output location\nk0rdentd export-worker-artifacts -o /path/to/output\n\n# With bundle reference\nk0rdentd export-worker-artifacts -b /path/to/bundle.tar.gz\n</code></pre>"},{"location":"user-guide/cli-reference/#what-it-does_4","title":"What It Does","text":"<ol> <li>Extracts embedded K0s binary</li> <li>Creates bundle reference file</li> <li>Generates helper scripts</li> <li>Creates README with instructions</li> </ol>"},{"location":"user-guide/cli-reference/#show-flavor","title":"show-flavor","text":"<p>Show the build flavor (online or airgap).</p>"},{"location":"user-guide/cli-reference/#usage_6","title":"Usage","text":"<pre><code>k0rdentd show-flavor [flags]\n</code></pre>"},{"location":"user-guide/cli-reference/#examples_6","title":"Examples","text":"<pre><code>k0rdentd show-flavor\n</code></pre>"},{"location":"user-guide/cli-reference/#output_1","title":"Output","text":"<pre><code>airgap\n</code></pre> <p>or</p> <pre><code>online\n</code></pre>"},{"location":"user-guide/cli-reference/#config","title":"config","text":"<p>Manage configuration (placeholder for future use).</p>"},{"location":"user-guide/cli-reference/#usage_7","title":"Usage","text":"<pre><code>k0rdentd config [command]\n</code></pre>"},{"location":"user-guide/cli-reference/#subcommands","title":"Subcommands","text":"Command Description <code>view</code> View current configuration <code>validate</code> Validate configuration file"},{"location":"user-guide/cli-reference/#environment-variables","title":"Environment Variables","text":"<p>All CLI flags can be set via environment variables:</p> Variable Equivalent Flag <code>K0RDENTD_CONFIG_FILE</code> <code>--config-file</code> <code>K0RDENTD_DEBUG</code> <code>--debug</code> <code>K0RDENTD_LOG_LEVEL</code> (sets log level) <code>K0RDENTD_K0S_VERSION</code> (sets k0s.version in config) <code>K0RDENTD_K0RDENT_VERSION</code> (sets k0rdent.version in config) <code>K0RDENTD_AIRGAP_BUNDLE_PATH</code> (sets airgap.bundlePath in config) <code>K0RDENTD_REGISTRY_ADDRESS</code> (sets airgap.registry.address in config) <code>K0RDENTD_REGISTRY_PORT</code> <code>--port</code> (for registry command) <code>K0RDENTD_REGISTRY_STORAGE</code> <code>--storage</code> (for registry command)"},{"location":"user-guide/cli-reference/#logging","title":"Logging","text":"<p>K0rdentd uses logrus for logging with the following levels:</p> Level Usage DEBUG Intermediate steps during processing INFO Finished steps relevant to user WARN Unexpected behavior, ignored errors ERROR Critical errors"},{"location":"user-guide/cli-reference/#enabling-debug-logging","title":"Enabling Debug Logging","text":"<pre><code># Via flag\nsudo k0rdentd install --debug\n\n# Via environment variable\nexport K0RDENTD_DEBUG=true\nsudo k0rdentd install\n\n# Via config file\ndebug: true\n</code></pre>"},{"location":"user-guide/cli-reference/#exit-codes_1","title":"Exit Codes","text":"<p>Common exit codes across all commands:</p> Code Meaning 0 Success 1 General error 2 Configuration error 3 Installation/uninstallation error 4 Runtime error 130 Interrupted (Ctrl+C)"},{"location":"user-guide/cloud-credentials/","title":"Cloud Credentials","text":"<p>K0rdentd can automatically create cloud provider credentials for K0rdent during installation. This allows K0rdent to provision and manage Kubernetes clusters on AWS, Azure, and OpenStack.</p>"},{"location":"user-guide/cloud-credentials/#overview","title":"Overview","text":"<p>When you configure cloud credentials in <code>k0rdentd.yaml</code>, K0rdentd creates the necessary Kubernetes objects:</p> <ol> <li>Secret: Stores sensitive credential data</li> <li>Identity: Cloud provider identity (AWS/Azure only)</li> <li>Credential: K0rdent credential object</li> </ol>"},{"location":"user-guide/cloud-credentials/#configuration","title":"Configuration","text":""},{"location":"user-guide/cloud-credentials/#aws-credentials","title":"AWS Credentials","text":"<pre><code>k0rdent:\n  credentials:\n    aws:\n      - name: aws-prod-credentials\n        region: us-east-1\n        accessKeyID: AKIA...\n        secretAccessKey: secret...\n        sessionToken: \"...\"  # Optional: for MFA or SSO\n</code></pre>"},{"location":"user-guide/cloud-credentials/#required-fields","title":"Required Fields","text":"Field Description <code>name</code> Credential name (used for all created resources) <code>region</code> Default AWS region <code>accessKeyID</code> AWS Access Key ID <code>secretAccessKey</code> AWS Secret Access Key"},{"location":"user-guide/cloud-credentials/#optional-fields","title":"Optional Fields","text":"Field Description <code>sessionToken</code> Session token for MFA or SSO authentication"},{"location":"user-guide/cloud-credentials/#created-resources","title":"Created Resources","text":"<ol> <li>Secret: <code>&lt;name&gt;-secret</code></li> <li>AWSClusterStaticIdentity: <code>&lt;name&gt;-identity</code></li> <li>Credential: <code>&lt;name&gt;</code></li> </ol>"},{"location":"user-guide/cloud-credentials/#azure-credentials","title":"Azure Credentials","text":"<pre><code>k0rdent:\n  credentials:\n    azure:\n      - name: azure-prod-credentials\n        subscriptionID: subscription-uuid...\n        clientID: client-uuid...\n        clientSecret: secret...\n        tenantID: tenant-uuid...\n</code></pre>"},{"location":"user-guide/cloud-credentials/#required-fields_1","title":"Required Fields","text":"Field Description <code>name</code> Credential name <code>subscriptionID</code> Azure Subscription ID <code>clientID</code> Service Principal Client ID <code>clientSecret</code> Service Principal Client Secret <code>tenantID</code> Azure Tenant ID"},{"location":"user-guide/cloud-credentials/#created-resources_1","title":"Created Resources","text":"<ol> <li>Secret: <code>&lt;name&gt;-secret</code></li> <li>AzureClusterIdentity: <code>&lt;name&gt;-identity</code></li> <li>Credential: <code>&lt;name&gt;</code></li> </ol>"},{"location":"user-guide/cloud-credentials/#openstack-credentials","title":"OpenStack Credentials","text":"<pre><code>k0rdent:\n  credentials:\n    openstack:\n      - name: openstack-prod-credentials\n        authURL: https://auth.example.com:5000/v3\n        region: RegionOne\n        applicationCredentialID: app-cred-id...\n        applicationCredentialSecret: app-cred-secret...\n</code></pre>"},{"location":"user-guide/cloud-credentials/#application-credential-authentication","title":"Application Credential Authentication","text":"Field Description <code>name</code> Credential name <code>authURL</code> Keystone authentication URL <code>region</code> OpenStack region <code>applicationCredentialID</code> Application Credential ID <code>applicationCredentialSecret</code> Application Credential Secret"},{"location":"user-guide/cloud-credentials/#usernamepassword-authentication-alternative","title":"Username/Password Authentication (Alternative)","text":"<pre><code>k0rdent:\n  credentials:\n    openstack:\n      - name: openstack-prod-credentials\n        authURL: https://auth.example.com:5000/v3\n        region: RegionOne\n        username: admin\n        password: secret...\n        projectName: myproject\n        domainName: default\n</code></pre>"},{"location":"user-guide/cloud-credentials/#created-resources_2","title":"Created Resources","text":"<ol> <li>Secret: <code>&lt;name&gt;-config</code> (contains clouds.yaml)</li> <li>Credential: <code>&lt;name&gt;</code></li> </ol>"},{"location":"user-guide/cloud-credentials/#multiple-credentials","title":"Multiple Credentials","text":"<p>You can configure multiple credentials for the same or different providers:</p> <pre><code>k0rdent:\n  credentials:\n    aws:\n      - name: aws-prod\n        region: us-east-1\n        accessKeyID: AKIA...\n        secretAccessKey: secret...\n      - name: aws-dev\n        region: us-west-2\n        accessKeyID: AKIA...\n        secretAccessKey: secret...\n    azure:\n      - name: azure-prod\n        subscriptionID: sub-id...\n        clientID: client-id...\n        clientSecret: secret...\n        tenantID: tenant-id...\n    openstack:\n      - name: openstack-prod\n        authURL: https://auth.example.com:5000/v3\n        region: RegionOne\n        applicationCredentialID: app-cred...\n        applicationCredentialSecret: secret...\n</code></pre>"},{"location":"user-guide/cloud-credentials/#idempotency","title":"Idempotency","text":"<p>Credential creation is idempotent:</p> <ul> <li>Each resource is checked before creation</li> <li>Existing resources are skipped</li> <li>Partial state recovery is supported</li> <li>Safe to run multiple times</li> </ul>"},{"location":"user-guide/cloud-credentials/#timing-considerations","title":"Timing Considerations","text":"<p>CAPI Provider Timing</p> <p>Credentials are created after K0rdent is installed, but CAPI infrastructure providers may not be ready yet. If credential creation fails, you may need to wait and retry.</p> <p>The installer waits for CAPI provider Helm releases to be deployed before creating credentials. If this times out, credential creation will log warnings but won't fail the installation.</p>"},{"location":"user-guide/cloud-credentials/#security-best-practices","title":"Security Best Practices","text":""},{"location":"user-guide/cloud-credentials/#1-use-environment-variables","title":"1. Use Environment Variables","text":"<p>Don't hardcode credentials in configuration files:</p> <pre><code>k0rdent:\n  credentials:\n    aws:\n      - name: aws-prod\n        region: us-east-1\n        accessKeyID: ${AWS_ACCESS_KEY_ID}\n        secretAccessKey: ${AWS_SECRET_ACCESS_KEY}\n</code></pre>"},{"location":"user-guide/cloud-credentials/#2-restrict-file-permissions","title":"2. Restrict File Permissions","text":"<pre><code># Set restrictive permissions on config file\nsudo chmod 600 /etc/k0rdentd/k0rdentd.yaml\n</code></pre>"},{"location":"user-guide/cloud-credentials/#3-use-short-lived-credentials","title":"3. Use Short-Lived Credentials","text":"<p>For AWS, use IAM roles with temporary credentials:</p> <pre><code>k0rdent:\n  credentials:\n    aws:\n      - name: aws-prod\n        region: us-east-1\n        accessKeyID: ${AWS_ACCESS_KEY_ID}\n        secretAccessKey: ${AWS_SECRET_ACCESS_KEY}\n        sessionToken: ${AWS_SESSION_TOKEN}  # Short-lived\n</code></pre>"},{"location":"user-guide/cloud-credentials/#4-audit-credential-usage","title":"4. Audit Credential Usage","text":"<pre><code># List credentials\nsudo k0s kubectl get credentials -n kcm-system\n\n# Check credential details\nsudo k0s kubectl describe credential aws-prod -n kcm-system\n</code></pre>"},{"location":"user-guide/cloud-credentials/#troubleshooting","title":"Troubleshooting","text":""},{"location":"user-guide/cloud-credentials/#credential-creation-failed","title":"Credential Creation Failed","text":"<p>Symptom: Warning messages during installation about credential creation failure.</p> <p>Cause: CAPI infrastructure providers not yet installed.</p> <p>Solution: Wait for providers to be ready and retry:</p> <pre><code># Check CAPI providers\nsudo k0s kubectl get deployments -n capi-system\n\n# Manually create credentials\nsudo k0rdentd install  # Re-run to retry credential creation\n</code></pre>"},{"location":"user-guide/cloud-credentials/#secret-already-exists","title":"Secret Already Exists","text":"<p>Symptom: \"Secret already exists\" error.</p> <p>Cause: Previous installation attempt created resources.</p> <p>Solution: This is handled by idempotency - existing resources are skipped.</p>"},{"location":"user-guide/cloud-credentials/#invalid-credentials","title":"Invalid Credentials","text":"<p>Symptom: Credentials created but K0rdent can't use them.</p> <p>Cause: Invalid credential values.</p> <p>Solution: Verify credentials manually:</p> <pre><code># For AWS\naws sts get-caller-identity --profile test-profile\n\n# For Azure\naz login --service-principal -u CLIENT_ID -p CLIENT_SECRET --tenant TENANT_ID\n</code></pre>"},{"location":"user-guide/cloud-credentials/#manual-credential-creation","title":"Manual Credential Creation","text":"<p>If automatic creation fails, you can create credentials manually:</p>"},{"location":"user-guide/cloud-credentials/#aws-example","title":"AWS Example","text":"<pre><code>apiVersion: v1\nkind: Secret\nmetadata:\n  name: aws-prod-secret\n  namespace: kcm-system\ntype: Opaque\nstringData:\n  AccessKeyID: AKIA...\n  SecretAccessKey: secret...\n---\napiVersion: infrastructure.cluster.x-k8s.io/v1beta2\nkind: AWSClusterStaticIdentity\nmetadata:\n  name: aws-prod-identity\n  namespace: kcm-system\nspec:\n  secretRef: aws-prod-secret\n  allowedNamespaces:\n    selector:\n      matchLabels: {}\n---\napiVersion: k0rdent.mirantis.com/v1beta1\nkind: Credential\nmetadata:\n  name: aws-prod\n  namespace: kcm-system\nspec:\n  description: \"AWS production credentials\"\n  identityRef:\n    apiVersion: infrastructure.cluster.x-k8s.io/v1beta2\n    kind: AWSClusterStaticIdentity\n    name: aws-prod-identity\n    namespace: kcm-system\n</code></pre> <p>Apply with:</p> <pre><code>sudo k0s kubectl apply -f credentials.yaml\n</code></pre>"},{"location":"user-guide/cloud-credentials/#references","title":"References","text":"<ul> <li>K0rdent Credentials Documentation</li> <li>Cluster API AWS Provider</li> <li>Cluster API Azure Provider</li> <li>Cluster API OpenStack Provider</li> </ul>"},{"location":"user-guide/exposing-ui/","title":"Exposing the K0rdent UI","text":"<p>K0rdentd can automatically expose the K0rdent UI and provide access URLs. This guide explains how to use the <code>expose-ui</code> command and what it does.</p>"},{"location":"user-guide/exposing-ui/#overview","title":"Overview","text":"<p>The <code>expose-ui</code> command:</p> <ol> <li>Waits for the K0rdent UI deployment to be ready</li> <li>Creates an ingress to expose the UI</li> <li>Detects VM IP addresses</li> <li>Tests UI accessibility</li> <li>Displays access URLs</li> </ol>"},{"location":"user-guide/exposing-ui/#usage","title":"Usage","text":""},{"location":"user-guide/exposing-ui/#automatic-exposure-during-install","title":"Automatic Exposure (During Install)","text":"<p>The UI is automatically exposed during <code>k0rdentd install</code>. You'll see output like:</p> <pre><code>\u2713 K0rdent UI is ready\nAccess the K0rdent UI at:\n  http://192.168.1.10/k0rdent-ui\n  http://10.0.0.5/k0rdent-ui\n</code></pre>"},{"location":"user-guide/exposing-ui/#manual-exposure","title":"Manual Exposure","text":"<p>To expose the UI manually:</p> <pre><code>sudo k0rdentd expose-ui\n</code></pre>"},{"location":"user-guide/exposing-ui/#command-options","title":"Command Options","text":"<pre><code># Custom timeout (default: 5m)\nsudo k0rdentd expose-ui --timeout 10m\n\n# Custom ingress path (default: /k0rdent-ui)\nsudo k0rdentd expose-ui --path /ui\n\n# Debug mode\nsudo k0rdentd expose-ui --debug\n</code></pre>"},{"location":"user-guide/exposing-ui/#how-it-works","title":"How It Works","text":""},{"location":"user-guide/exposing-ui/#step-1-wait-for-ui-deployment","title":"Step 1: Wait for UI Deployment","text":"<p>The command waits for the <code>k0rdent-k0rdent-ui</code> deployment to be ready:</p> <pre><code>graph LR\n    A[Start] --&gt; B{Deployment Ready?}\n    B --&gt;|No| C[Wait 5s]\n    C --&gt; B\n    B --&gt;|Yes| D[Continue]</code></pre>"},{"location":"user-guide/exposing-ui/#step-2-create-ingress","title":"Step 2: Create Ingress","text":"<p>Creates an ingress object to expose the UI:</p> <pre><code>apiVersion: networking.k8s.io/v1\nkind: Ingress\nmetadata:\n  name: k0rdent-ui\n  namespace: kcm-system\nspec:\n  rules:\n    - http:\n        paths:\n          - path: /k0rdent-ui\n            pathType: Prefix\n            backend:\n              service:\n                name: k0rdent-k0rdent-ui\n                port:\n                  number: 80\n</code></pre>"},{"location":"user-guide/exposing-ui/#step-3-detect-ip-addresses","title":"Step 3: Detect IP Addresses","text":"<p>The command detects IP addresses from multiple sources:</p> <ol> <li>Network Interfaces: Parses <code>ip addr</code> output</li> <li>Cloud Metadata: Queries cloud provider metadata services</li> <li>VPN Interfaces: Includes VPN addresses (Tailscale, etc.)</li> </ol>"},{"location":"user-guide/exposing-ui/#filtering","title":"Filtering","text":"<p>The following interfaces are excluded:</p> <ul> <li>Calico interfaces (<code>cali*</code>, <code>vxlan.calico</code>)</li> <li>Docker interfaces (<code>docker*</code>, <code>br-*</code>)</li> <li>Loopback (<code>lo</code>)</li> <li>Internal Kubernetes interfaces</li> </ul>"},{"location":"user-guide/exposing-ui/#cloud-provider-detection","title":"Cloud Provider Detection","text":"Provider Detection Method Metadata URL AWS BIOS vendor check <code>http://169.254.169.254/latest/meta-data/</code> Azure BIOS vendor check <code>http://169.254.169.254/metadata/instance?api-version=2021-02-01</code> GCP BIOS vendor check <code>http://metadata.google.internal/computeMetadata/v1/instance/</code>"},{"location":"user-guide/exposing-ui/#step-4-test-accessibility","title":"Step 4: Test Accessibility","text":"<p>The command tests if the UI is accessible on each detected IP:</p> <pre><code>curl -s -o /dev/null -w \"%{http_code}\" http://IP/k0rdent-ui\n</code></pre> <p>Only IPs that return a valid HTTP response are displayed.</p>"},{"location":"user-guide/exposing-ui/#step-5-display-urls","title":"Step 5: Display URLs","text":"<p>Finally, the command displays all valid access URLs:</p> <pre><code>\u2713 K0rdent UI is accessible at:\n  http://192.168.1.10/k0rdent-ui\n  http://10.0.0.5/k0rdent-ui\n\nFor remote access, use SSH port forwarding:\n  ssh -L 8080:localhost:NODEPORT user@host\n</code></pre>"},{"location":"user-guide/exposing-ui/#access-methods","title":"Access Methods","text":""},{"location":"user-guide/exposing-ui/#direct-access","title":"Direct Access","text":"<p>If the VM has a publicly accessible IP:</p> <pre><code>http://PUBLIC_IP/k0rdent-ui\n</code></pre>"},{"location":"user-guide/exposing-ui/#nodeport-access","title":"NodePort Access","text":"<p>If ingress is not available, use NodePort:</p> <pre><code># Get NodePort\nNODEPORT=$(sudo k0s kubectl get svc -n kcm-system k0rdent-k0rdent-ui -o jsonpath='{.spec.ports[0].nodePort}')\n\n# Access\nhttp://IP:NODEPORT\n</code></pre>"},{"location":"user-guide/exposing-ui/#ssh-port-forwarding","title":"SSH Port Forwarding","text":"<p>For secure remote access:</p> <pre><code># Get NodePort\nNODEPORT=$(sudo k0s kubectl get svc -n kcm-system k0rdent-k0rdent-ui -o jsonpath='{.spec.ports[0].nodePort}')\n\n# Create tunnel\nssh -L 8080:localhost:$NODEPORT user@host\n\n# Access\nhttp://localhost:8080/k0rdent-ui\n</code></pre>"},{"location":"user-guide/exposing-ui/#port-forwarding-with-kubectl","title":"Port Forwarding with kubectl","text":"<p>Alternative using kubectl port-forward:</p> <pre><code># Port forward\nsudo k0s kubectl port-forward -n kcm-system svc/k0rdent-k0rdent-ui 8080:80\n\n# Access\nhttp://localhost:8080/k0rdent-ui\n</code></pre>"},{"location":"user-guide/exposing-ui/#troubleshooting","title":"Troubleshooting","text":""},{"location":"user-guide/exposing-ui/#ui-not-ready","title":"UI Not Ready","text":"<p>Symptom: Timeout waiting for UI deployment.</p> <p>Solution: Check deployment status:</p> <pre><code># Check deployment\nsudo k0s kubectl get deployment -n kcm-system k0rdent-k0rdent-ui\n\n# Check pods\nsudo k0s kubectl get pods -n kcm-system -l app.kubernetes.io/name=k0rdent-ui\n\n# Check logs\nsudo k0s kubectl logs -n kcm-system -l app.kubernetes.io/name=k0rdent-ui\n</code></pre>"},{"location":"user-guide/exposing-ui/#ingress-not-working","title":"Ingress Not Working","text":"<p>Symptom: Ingress created but UI not accessible.</p> <p>Solution: Check ingress controller:</p> <pre><code># Check ingress\nsudo k0s kubectl get ingress -n kcm-system\n\n# Check ingress controller\nsudo k0s kubectl get pods -A | grep ingress\n\n# Check ingress logs\nsudo k0s kubectl logs -n ingress-nginx -l app.kubernetes.io/name=ingress-nginx\n</code></pre>"},{"location":"user-guide/exposing-ui/#no-ip-addresses-found","title":"No IP Addresses Found","text":"<p>Symptom: No IPs detected or all filtered out.</p> <p>Solution: Check network interfaces:</p> <pre><code># List interfaces\nip addr\n\n# Check for valid interfaces\nip addr | grep -E \"inet \" | grep -v \"127.0.0.1\"\n</code></pre>"},{"location":"user-guide/exposing-ui/#ui-returns-404","title":"UI Returns 404","text":"<p>Symptom: HTTP 404 when accessing UI.</p> <p>Solution: Check ingress path:</p> <pre><code># Check ingress path\nsudo k0s kubectl get ingress -n kcm-system k0rdent-ui -o yaml\n\n# Verify service\nsudo k0s kubectl get svc -n kcm-system k0rdent-k0rdent-ui\n</code></pre>"},{"location":"user-guide/exposing-ui/#manual-ingress-creation","title":"Manual Ingress Creation","text":"<p>If automatic exposure fails, create ingress manually:</p> <pre><code>apiVersion: networking.k8s.io/v1\nkind: Ingress\nmetadata:\n  name: k0rdent-ui\n  namespace: kcm-system\n  annotations:\n    nginx.ingress.kubernetes.io/rewrite-target: /\nspec:\n  rules:\n    - http:\n        paths:\n          - path: /k0rdent-ui\n            pathType: Prefix\n            backend:\n              service:\n                name: k0rdent-k0rdent-ui\n                port:\n                  number: 80\n</code></pre> <p>Apply with:</p> <pre><code>sudo k0s kubectl apply -f ingress.yaml\n</code></pre>"},{"location":"user-guide/exposing-ui/#security-considerations","title":"Security Considerations","text":""},{"location":"user-guide/exposing-ui/#production-deployments","title":"Production Deployments","text":"<p>For production, consider:</p> <ol> <li>TLS/HTTPS: Add TLS configuration to ingress</li> <li>Authentication: Add authentication annotations</li> <li>Network Policies: Restrict access with network policies</li> </ol>"},{"location":"user-guide/exposing-ui/#tls-example","title":"TLS Example","text":"<pre><code>apiVersion: networking.k8s.io/v1\nkind: Ingress\nmetadata:\n  name: k0rdent-ui\n  namespace: kcm-system\n  annotations:\n    cert-manager.io/cluster-issuer: letsencrypt-prod\nspec:\n  tls:\n    - hosts:\n        - k0rdent.example.com\n      secretName: k0rdent-ui-tls\n  rules:\n    - host: k0rdent.example.com\n      http:\n        paths:\n          - path: /\n            pathType: Prefix\n            backend:\n              service:\n                name: k0rdent-k0rdent-ui\n                port:\n                  number: 80\n</code></pre>"},{"location":"user-guide/exposing-ui/#references","title":"References","text":"<ul> <li>K0rdent UI Documentation</li> <li>Kubernetes Ingress</li> <li>NGINX Ingress Controller</li> </ul>"}]}